(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1414],{3764:(e,t,a)=>{"use strict";a.d(t,{A:()=>_});var s=a(33284);let _={getFAQ:async(e,t)=>(await s.Ay.get("/faq",{headers:{"Accept-Language":e||"en"},params:t})).data,createFAQ:async(e,t)=>(await s.Ay.post("/faq",e,{headers:{"Accept-Language":t||"en"}})).data,updateFAQ:async(e,t)=>(await s.Ay.put("/faq/".concat(e.id),{question:e.question,answer:e.answer,questionTranslations:(null==e?void 0:e.questionTranslations)||{ru:"ru"===t?e.question:"",en:"en"===t?e.question:"",zh:"zh"===t?e.question:""},answerTranslations:(null==e?void 0:e.answerTranslations)||{ru:"ru"===t?e.answer:"",en:"en"===t?e.answer:"",zh:"zh"===t?e.answer:""}},{headers:{"Accept-Language":t||"en"}})).data,deleteFAQ:async(e,t)=>(await s.Ay.delete("/faq/".concat(e),{headers:{"Accept-Language":t||"en"}})).data}},7736:e=>{e.exports={save__animation:"ProfilePage_save__animation__hDxqk",fadeIn:"ProfilePage_fadeIn__vlhPt",profile__user__box:"ProfilePage_profile__user__box__VrdzD",profile__shops__char__data:"ProfilePage_profile__shops__char__data__q6YSp",profile__shops__data:"ProfilePage_profile__shops__data__n4HYS",profile__data__mini:"ProfilePage_profile__data__mini__oZqZu",profile__user__box__inner:"ProfilePage_profile__user__box__inner__PreuA",profile__user__box__inner__avatar:"ProfilePage_profile__user__box__inner__avatar__s0a2o",user__names__box:"ProfilePage_user__names__box__irOWU",user__name:"ProfilePage_user__name__nBmEP",user__email:"ProfilePage_user__email___1ur6",fast__buttons__box:"ProfilePage_fast__buttons__box__f5LaU",fast__buttons__box__item__button:"ProfilePage_fast__buttons__box__item__button__he2Zw",fast__buttons__box__item:"ProfilePage_fast__buttons__box__item__BGMhf",create__box:"ProfilePage_create__box__r4cJ9",region__box:"ProfilePage_region__box__84sx4",input__title:"ProfilePage_input__title___WaZI",phone__input__box:"ProfilePage_phone__input__box__rqMnH",profile__region__dropdown:"ProfilePage_profile__region__dropdown__WNOhq",modal__sessions__list__item__button:"ProfilePage_modal__sessions__list__item__button__Wi4xs",region__box__input:"ProfilePage_region__box__input__rCtVI",extra__phone__class:"ProfilePage_extra__phone__class__kBSzl",buttons__logouts__box:"ProfilePage_buttons__logouts__box__kq7d_",buttons__logouts__box__item:"ProfilePage_buttons__logouts__box__item__CeTgW",buttons__logouts__box__button:"ProfilePage_buttons__logouts__box__button__MVrHR",logout__button:"ProfilePage_logout__button__TkPgL",profile__data__favourite:"ProfilePage_profile__data__favourite__5wXi_",profile__data__basket:"ProfilePage_profile__data__basket__a0rgi",profile__data__favourite__span:"ProfilePage_profile__data__favourite__span__m_7mP",mini__link__info__title:"ProfilePage_mini__link__info__title__Eow_t",profile__data__favourite__subtitle:"ProfilePage_profile__data__favourite__subtitle__0QRZm",profile__data__latest:"ProfilePage_profile__data__latest__lPc3D",mini__link__info__title__latest:"ProfilePage_mini__link__info__title__latest__Ra15t",profile__inner:"ProfilePage_profile__inner__UqZUR",modal__sessions__title:"ProfilePage_modal__sessions__title__fBsiO",modal__sessions__list:"ProfilePage_modal__sessions__list__WB0sz",modal__sessions__list__item:"ProfilePage_modal__sessions__list__item__QQS_X",device__type:"ProfilePage_device__type__gRqu9",browser:"ProfilePage_browser__SNdwe",os:"ProfilePage_os__kRPyE",last__login__date:"ProfilePage_last__login__date__pDhj2",sessions__item__title:"ProfilePage_sessions__item__title__5NJMv",extra__input:"ProfilePage_extra__input__VLtD0",buttons__box__save__logout:"ProfilePage_buttons__box__save__logout__6y7CU",save__button:"ProfilePage_save__button__948IB",latest__list:"ProfilePage_latest__list__UVNh6",empty__message:"ProfilePage_empty__message__opdo_",payments__methods__title:"ProfilePage_payments__methods__title__ZfqIj",payments__methods__list:"ProfilePage_payments__methods__list__99qyt",payments__methods__list__item:"ProfilePage_payments__methods__list__item__9GqR4",payments__methods__list__item__title:"ProfilePage_payments__methods__list__item__title__PipLv",payments__methods__list__item__value:"ProfilePage_payments__methods__list__item__value__gOVgi"}},8767:e=>{e.exports={phone__input__box:"ProfileForm_phone__input__box__nfVHC",profile__region__dropdown:"ProfileForm_profile__region__dropdown__Y4ZlI",region__box__input:"ProfileForm_region__box__input__ZqVj5",extra_extraDropListClass:"ProfileForm_extra_extraDropListClass__KyeCg",extra__phone__class:"ProfileForm_extra__phone__class__zdsce",buttons__logouts__box:"ProfileForm_buttons__logouts__box__VxmAD",input__title:"ProfileForm_input__title__DMDfy",create__box:"ProfileForm_create__box__wWyUZ",extra__input:"ProfileForm_extra__input__Y0GG5",region__box:"ProfileForm_region__box__6VI_6",modal__text:"ProfileForm_modal__text__RbhRd",modal__text__mini:"ProfileForm_modal__text__mini__zvUCL",extra__input__inn:"ProfileForm_extra__input__inn__jbxnJ",region__box__second:"ProfileForm_region__box__second__ibOzB",profile__region__dropdown__extra:"ProfileForm_profile__region__dropdown__extra__1fyy_"}},10082:(e,t,a)=>{"use strict";a.d(t,{A:()=>g,c:()=>m});var s=a(95155),_=a(12115),l=a(43323),o=a.n(l),i=a(66766),r=a(37220),n=a(53384),c=a(17652),d=a(3764),u=a(60584);let m=e=>{let{linkTo:t,extraClass:a,iconSrc:_,text:l,onClick:r}=e;return(0,s.jsxs)("li",{style:{cursor:"pointer"},onClick:r,className:"".concat(o().help__content__item," ").concat(a),children:[(0,s.jsx)(i.default,{src:_,alt:l,width:27,height:27}),(0,s.jsx)("p",{children:l})]})},g=()=>{let[e,t]=(0,_.useState)(!1),a=(0,c.c3)("ProfilePage.ProfilePageBottomHelp"),[l,i]=(0,_.useState)([]),g=(0,u.f4)();(0,_.useEffect)(()=>{(async()=>{try{let e=await d.A.getFAQ(g);i(e)}catch(e){console.error("Error fetching FAQ data:",e)}})()},[]);let p=[{linkTo:"#",iconSrc:"/profile/help_chat_svg.svg",text:a("support")},{linkTo:"#",iconSrc:"/profile/quest.svg",text:a("quest")}];return(0,s.jsxs)("div",{className:"".concat(o().help__box),children:[(0,s.jsxs)(r.A,{extraClass:o().faq__modal,isOpen:e,onClose:()=>t(!1),children:[(0,s.jsx)("h3",{style:{fontSize:"30px",fontWeight:"500",textAlign:"center",margin:"10px 60px 40px 60px"},children:a("title")}),(0,s.jsx)(n.A,{items:l.length>0?l.map(e=>({title:e.question,value:e.answer,id:e.question.toString()})):[{title:a("questNotFoundTitle"),value:a("questNotFoundValue"),id:"questNotFound"}]})]}),(0,s.jsx)("h3",{className:"".concat(o().help__box__title),children:a("service")}),(0,s.jsx)("ul",{className:"".concat(o().help__content),children:p.map((e,a)=>(0,s.jsx)(m,{text:e.text,iconSrc:e.iconSrc,linkTo:e.linkTo,onClick:()=>{1===a&&t(!0)}},a))})]})}},11414:(e,t,a)=>{"use strict";a.d(t,{DV:()=>U,N0:()=>V,bk:()=>q,ZZ:()=>O,default:()=>M});var s=a(95155),_=a(12115),l=a(7736),o=a.n(l),i=a(75081),r=a(33284),n=a(71747),c=a(66766),d=a(6874),u=a.n(d),m=a(94872),g=a(48213),p=a(10082),h=a(43323),x=a.n(h),f=a(41287),v=a(17652),b=a(60584);let P=()=>{let e=(0,v.c3)("ProfilePage.ProfilePageBottomDelivery"),[t,a]=(0,_.useState)([]),l=(0,b.f4)();return(0,_.useEffect)(()=>{(async()=>{try{let e=await r.Ay.get("/me/reviews",{headers:{"Accept-Language":l}});console.log("response reviews",e),a(e.data.content)}catch(e){console.error("Error fetching reviews:",e)}})()},[l]),(0,s.jsxs)("div",{className:"".concat(x().delivery__box),children:[(0,s.jsx)("h3",{className:"".concat(x().delivery__box__title),children:e("title")}),(0,s.jsxs)("ul",{className:"".concat(x().delivery__list),children:[(null==t?void 0:t.length)===0&&(0,s.jsx)("p",{children:e("noReviews")}),null==t?void 0:t.map((e,t)=>(0,s.jsx)(f.A,{...e},t))]})]})};var y=a(59619),j=a(37220),N=a(35695),w=a(29795),S=a(56671),k=a(75543),C=a.n(k),A=a(70724);let D=e=>{let{avatarUrl:t,onAvatarChange:a,isOnlyShow:l=!1}=e,[o,i]=(0,_.useState)(!1),[r,d]=(0,_.useState)(!1),[u,m]=(0,_.useState)(null),g=(0,_.useRef)(null),p=(0,v.c3)("ProfilePage"),h=u||t||"/avatars/avatar-v-2.svg",x=!!(u||t),{invalidateUser:f}=(0,A.Z1)(),{refetch:b}=(0,A.tg)(),P=async e=>{d(!0);try{let t=new FormData;if(t.append("file",e),(await fetch("".concat("https://exporteru.com","/api/v1/me/avatar"),{method:"PUT",headers:{Authorization:"Bearer ".concat((0,n.iD)())},body:t})).ok)S.o.success((0,s.jsxs)("div",{style:{lineHeight:1.5,marginLeft:"10px"},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4,fontSize:"18px"},children:p("congratulations")}),(0,s.jsx)("span",{children:p("createAvatarSuccess")})]}),{style:{background:"#2E7D32"}}),null==a||a(u),await f(),await b();else throw S.o.error((0,s.jsxs)("div",{style:{lineHeight:1.5},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4},children:p("dataErrorChange")}),(0,s.jsx)("span",{children:p("createAvatarError")})]}),{style:{background:"#AC2525"}}),Error("Failed to upload avatar")}catch(e){console.error("Error uploading avatar:",e),u&&(URL.revokeObjectURL(u),m(null))}finally{d(!1),g.current&&(g.current.value="")}},y=async()=>{d(!0);try{if((await fetch("".concat("https://exporteru.com","/api/v1/me/avatar"),{method:"DELETE",headers:{Authorization:"Bearer ".concat((0,n.iD)())}})).ok)u&&URL.revokeObjectURL(u),m(null),null==a||a(null),S.o.success((0,s.jsxs)("div",{style:{lineHeight:1.5,marginLeft:"10px"},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4,fontSize:"18px"},children:p("congratulations")}),(0,s.jsx)("span",{children:p("deleteAvatarSuccess")})]}),{style:{background:"#2E7D32"}});else throw Error("Failed to delete avatar")}catch(e){S.o.error((0,s.jsxs)("div",{style:{lineHeight:1.5},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4},children:p("dataErrorChange")}),(0,s.jsx)("span",{children:p("deleteAvatarError")})]}),{style:{background:"#AC2525"}}),console.error("Error deleting avatar:",e)}finally{d(!1)}};return _.useEffect(()=>()=>{u&&URL.revokeObjectURL(u)},[u]),(0,s.jsxs)("div",{className:C().avatar,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onClick:()=>{if(!r)if(x)y();else{var e;null==(e=g.current)||e.click()}},style:{pointerEvents:l?"none":"auto"},children:[(0,s.jsx)(c.default,{width:60,height:60,src:h,alt:"avatar",className:C().avatar__image},h),(o||r)&&(0,s.jsx)("div",{className:C().avatar__overlay,children:r?(0,s.jsx)("div",{className:C().avatar__spinner}):(0,s.jsx)("div",{className:C().avatar__icon,children:x?"−":"+"})}),(0,s.jsx)("input",{ref:g,type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];return a?a.type.match(/^image\/(jpeg|jpg|png)$/)?a.size>2097152?void alert("Размер файла не должен превышать 2MB"):void(m(URL.createObjectURL(a)),P(a)):void alert("Поддерживаются только JPEG и PNG файлы"):void 0},className:C().avatar__input})]})};var E=a(11518),L=a.n(E),B=a(83419);let R=e=>{let{buttonText:t}=e,[a,l]=(0,_.useState)(!1),[o,i]=(0,_.useState)(!1),[n,c]=(0,_.useState)(""),d=(0,N.useRouter)(),{mutate:u}=(0,A.Wn)(),m=(0,v.c3)("DeleteButton"),g=async()=>{try{i(!0),c(""),await r.Ay.delete("/me/delete-account"),l(!0)}catch(a){var e,t;c((null==(t=a.response)||null==(e=t.data)?void 0:e.message)||m("errorDelete")),console.error("Delete account error:",a)}finally{i(!1)}},p=async e=>{try{i(!0),c(""),await r.Ay.delete("/me/verify-delete-account",{data:{code:e}}),u(),d.push("/")}catch(e){var t,a;c((null==(a=e.response)||null==(t=a.data)?void 0:t.message)||m("errorOtp")),console.error("Verify delete account error:",e)}finally{i(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"jsx-4c53b84d47ec151 buttons__logouts__box",children:(0,s.jsx)("div",{className:"jsx-4c53b84d47ec151 buttons__logouts__box__item",children:(0,s.jsx)("button",{onClick:g,disabled:o,className:"jsx-4c53b84d47ec151 buttons__logouts__box__button",children:o?m("loading"):t})})}),n&&(0,s.jsx)("div",{style:{color:"#ac2525",marginTop:"10px",fontSize:"14px"},className:"jsx-4c53b84d47ec151",children:n}),(0,s.jsx)(j.A,{isOpen:a,onClose:()=>{l(!1)},children:(0,s.jsxs)("div",{style:{padding:"20px",textAlign:"center"},className:"jsx-4c53b84d47ec151",children:[(0,s.jsx)("h3",{style:{marginBottom:"20px"},className:"jsx-4c53b84d47ec151",children:m("modalTitle")}),(0,s.jsx)("p",{style:{marginBottom:"20px"},className:"jsx-4c53b84d47ec151",children:m("modalDescription")}),(0,s.jsx)(B.A,{length:4,onComplete:p}),n&&(0,s.jsx)("div",{style:{color:"#ac2525",marginTop:"15px",fontSize:"14px"},className:"jsx-4c53b84d47ec151",children:n}),o&&(0,s.jsx)("div",{style:{marginTop:"15px",fontSize:"14px"},className:"jsx-4c53b84d47ec151",children:m("checkingCode")})]})}),(0,s.jsx)(L(),{id:"4c53b84d47ec151",children:".buttons__logouts__box.jsx-4c53b84d47ec151{display:flex;margin-top:25px;margin-bottom:35px;gap:30px}.buttons__logouts__box__item.jsx-4c53b84d47ec151{width:fit-content}.buttons__logouts__box__button.jsx-4c53b84d47ec151{padding:11px 18px;border:2px solid#ac2525;border-radius:10px;font-size:15px;background:transparent;color:inherit;cursor:pointer;transition:all.2s ease}.buttons__logouts__box__button.jsx-4c53b84d47ec151:hover:not(:disabled){padding:11px 17px;color:#ac2525;font-weight:500}.buttons__logouts__box__button.jsx-4c53b84d47ec151:disabled{opacity:.6;cursor:not-allowed}"})]})};var z=a(9013),F=a(87358);let U={avatar1:"/avatars/avatar-v-2.svg",belarusSvg:"/belarus.svg",kazakhstanSvg:"/countries/kazakhstan.svg",chinaSvg:"/countries/china.svg",russiaSvg:"/countries/russia.svg",redStar:"/profile/red_star.svg",basket:"/profile/red_basket.svg",paymentsList:[{title:"Банковская карта – Альфа банк",value:"1234 1234 1234 1234"},{title:"Банковская карта – Сбербанк",value:"4132 1234 4123 1234"},{title:"ERIP",value:"1234567ER0000001231PB"}]};function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ru",a=new Date(e);if(isNaN(a.getTime()))switch(t){case"en":return"Invalid date";case"zh":return"无效日期";default:return"Некорректная дата"}let s=a.getDate(),_=a.getMonth(),l=a.getFullYear();switch(t){case"en":return"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][_]," ").concat(s,", ").concat(l);case"zh":return"".concat(l,"年 ").concat(["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][_]," ").concat(s,"日");default:return"".concat(s," ").concat(["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"][_]," ").concat(l," года")}}let q=e=>{let{userData:t,isPageForVendor:a=!0}=e,{updateUserAvatar:_}=(0,z.d)();return(0,s.jsxs)("div",{className:o().profile__user__box__inner,children:[(0,s.jsx)(D,{onAvatarChange:e=>{console.log("newAvatarUrl",e),_(e||"")},isOnlyShow:!a,avatarUrl:null==t?void 0:t.avatarUrl}),(0,s.jsxs)("div",{className:o().user__names__box,children:[(0,s.jsxs)("p",{className:o().user__name,children:[null==t?void 0:t.login," "]}),(0,s.jsx)("p",{className:o().user__email,children:null==t?void 0:t.email})]})]})},O=e=>{let{onDevicesClick:t,onPaymentClick:a,isForVendor:l=!0}=e,i=(0,v.c3)("ProfilePage"),[n,c]=(0,_.useState)(!1),[d,u]=(0,_.useState)(!1),m=(0,b.f4)(),[g,p]=(0,_.useState)([]),h=async e=>{let t=S.o.loading(i("deleting"));try{await r.Ay.delete("/me/sessions/".concat(e),{headers:{"Accept-Language":m,"x-language":m}}),p(t=>t.filter(t=>t.id!==e)),S.o.dismiss(t),S.o.success((0,s.jsxs)("div",{style:{lineHeight:1.5,marginLeft:"10px"},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4,fontSize:"18px"},children:i("congratulations")}),(0,s.jsx)("span",{children:i("deletedSuccess")})]}),{style:{background:"#2E7D32"}})}catch(e){console.error(e),S.o.dismiss(t),S.o.error((0,s.jsxs)("div",{style:{lineHeight:1.5},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4},children:i("defaultError")}),(0,s.jsx)("span",{children:i("deletedError")})]}),{style:{background:"#AC2525"}})}},x=async e=>{t(e),e.preventDefault();try{let e=await r.Ay.get("/me/sessions",{headers:{"Accept-Language":m,"x-language":m}});p(e.data),c(!0)}catch(e){console.error(e)}};return(0,s.jsxs)("ul",{className:o().fast__buttons__box,children:[l&&(0,s.jsxs)(j.A,{isOpen:n,onClose:()=>c(!1),children:[(0,s.jsx)("p",{className:o().modal__sessions__title,children:i("mySessions")}),(0,s.jsx)("ul",{className:o().modal__sessions__list,children:g.map((e,t)=>(0,s.jsxs)("li",{style:{width:"100%",display:"flex",alignItems:"center"},children:[(0,s.jsxs)("div",{className:o().modal__sessions__list__item,children:[(0,s.jsxs)("p",{className:"".concat(o().device__type),children:[(0,s.jsxs)("span",{className:"".concat(o().sessions__item__title),children:[" ",i("deviceType"),":"]})," ",(0,s.jsx)("span",{className:"".concat(o().sessions__item__value),children:e.deviceType})]}),(0,s.jsxs)("p",{className:"".concat(o().browser),children:[(0,s.jsxs)("span",{className:"".concat(o().sessions__item__title),children:[" ",i("browser"),":"]})," ",(0,s.jsx)("span",{className:"".concat(o().sessions__item__value,"}"),children:e.browser})]}),(0,s.jsxs)("p",{className:"".concat(o().os),children:[(0,s.jsxs)("span",{className:"".concat(o().sessions__item__title),children:[" ",i("os"),":"]})," ",(0,s.jsx)("span",{className:"".concat(o().sessions__item__value,"}"),children:e.os})]}),(0,s.jsxs)("p",{className:"".concat(o().last__login__date),children:[(0,s.jsxs)("span",{className:"".concat(o().sessions__item__title),children:[" ",i("lastLoginDate"),":"]})," ",(0,s.jsx)("span",{className:"".concat(o().sessions__item__value),children:"string"==typeof e.lastLoginDate?T(e.lastLoginDate,m||"en"):T(e.lastLoginDate.toISOString(),m||"en")})]})]}),(0,s.jsx)("button",{className:o().modal__sessions__list__item__button,onClick:()=>{h(e.id)},children:"X"})]},t))})]}),l&&(0,s.jsx)("li",{className:o().fast__buttons__box__item,children:(0,s.jsx)("button",{className:o().fast__buttons__box__item__button,onClick:x,children:i("mySessions")})}),(0,s.jsxs)(j.A,{isOpen:d,onClose:()=>u(!1),children:[(0,s.jsx)("h3",{className:o().payments__methods__title,children:i("paymentsMethodsTitle")}),(0,s.jsx)("ul",{className:o().payments__methods__list,children:U.paymentsList.map((e,t)=>(0,s.jsxs)("li",{className:o().payments__methods__list__item,children:[(0,s.jsx)("p",{className:o().payments__methods__list__item__title,children:e.title}),(0,s.jsx)("p",{className:o().payments__methods__list__item__value,children:e.value})]},t))})]})]})},V=e=>{let{needToSave:t,onLogout:a,isLoading:l,phoneNumber:i,region:n,inn:c,countries:d,categories:u,isForVendor:g,address:p}=e,h=(0,v.c3)("ProfilePage"),x=(0,b.f4)(),f=(0,m.N)(e=>{var t,a;return null==(a=e.user)||null==(t=a.user)?void 0:t.vendorDetails}),[P,y]=(0,_.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(j.A,{isOpen:P,onClose:()=>{y(!1)},children:[(0,s.jsx)("p",{style:{textAlign:"center",fontWeight:"500",fontSize:"24px",margin:"10px 0 40px 0"},children:h("wannaGetOut")}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"40px"},children:[(0,s.jsx)("button",{style:{borderRadius:"10px",padding:"10px 20px",fontSize:"16px",fontWeight:"500",backgroundColor:"#2A2E46",color:"#fff"},onClick:()=>y(!1),children:h("cancel")}),(0,s.jsx)("button",{style:{borderRadius:"10px",padding:"10px 35px",fontSize:"16px",fontWeight:"500",backgroundColor:"#AC2525",color:"#fff"},onClick:a,children:h("logout")})]})]}),(0,s.jsx)(R,{buttonText:h("deleteAccount")}),(0,s.jsxs)("div",{className:o().buttons__box__save__logout,children:[(0,s.jsx)("button",{onClick:()=>y(!0),className:"".concat(o().logout__button," "),children:h("logout")}),t&&!l&&(0,s.jsx)("button",{className:"".concat(o().save__button,"  "),onClick:()=>{let e="";switch(n){case"Belarus":e="+375";break;case"Kazakhstan":case"Russia":e="+7";break;case"China":e="+86";break;case"Other":e="+"}try{if(g){let t=r.Ay.patch("/me",{phoneNumber:e+i,inn:c,countries:d,categories:u,address:(null==f?void 0:f.address)||p||""},{headers:{"Accept-Language":x,"x-language":x}});console.log(t)}else{let t=r.Ay.patch("/me",{phoneNumber:e+i,region:n},{headers:{"Accept-Language":x,"x-language":x}});console.log(t)}S.o.success((0,s.jsxs)("div",{style:{lineHeight:1.5,marginLeft:"10px"},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4,fontSize:"18px"},children:h("congratulations")}),(0,s.jsx)("span",{children:h("dataSuccessfullyChanged")})]}),{style:{background:"#2E7D32"}})}catch(e){S.o.error(h("dataErrorChange"))}},children:h("save")})]})]})},W=e=>{let{favoriteCount:t,registrationDate:a}=e,[l,i]=(0,_.useState)(!1);(0,_.useEffect)(()=>{i(!0)},[]);let r=(0,v.c3)("ProfilePage");return(0,s.jsxs)("div",{className:o().profile__data__mini,children:[(0,s.jsx)(u(),{href:"/favorites",className:o().profile__data__box_item__span,children:(0,s.jsxs)("span",{className:o().profile__data__favourite,children:[(0,s.jsxs)("span",{className:o().profile__data__favourite__span,children:[(0,s.jsx)("h3",{className:o().mini__link__info__title,children:r("favorites")}),(0,s.jsx)(c.default,{width:25,height:23,src:U.redStar,alt:"go to favorite"})]}),(0,s.jsxs)("p",{className:o().profile__data__favourite__subtitle,children:[l?t:0," ",r("products")]})]})}),(0,s.jsx)(u(),{href:"#",className:o().profile__data__box_item__span,children:(0,s.jsxs)("span",{className:o().profile__data__basket,children:[(0,s.jsxs)("span",{className:o().profile__data__favourite__span,children:[(0,s.jsx)("h3",{className:o().mini__link__info__title,children:a.length>0?r("shopping",{memberSince:new Date(a)}):""}),(0,s.jsx)(c.default,{width:25,height:23,src:U.basket,alt:"go to basket"})]}),(0,s.jsxs)("p",{className:o().profile__data__favourite__subtitle,children:[r("saw")," "]})]})})]})},I=e=>{let{latestViews:t,isEmpty:a}=e,[l,i]=(0,_.useState)(!1);(0,_.useEffect)(()=>{i(!0)},[]);let r=(0,v.c3)("ProfilePage");return(0,s.jsxs)("div",{className:o().profile__data__latest,children:[(0,s.jsx)("h3",{className:o().mini__link__info__title__latest,children:r("recentlyViewed")}),(0,s.jsxs)("ul",{className:o().latest__list,children:[l&&t.map(e=>(0,s.jsx)(g.A,{isLoading:!1,id:e.id,title:e.title,price:e.originalPrice,discount:e.discount,previewImageUrl:e.previewImageUrl,discountedPrice:e.discountedPrice,deliveryMethod:e.deliveryMethod,fullProduct:e},e.id)),l&&a&&(0,s.jsx)("p",{className:o().empty__message,children:r("notHaveRecentlyViewed")})]})]})},M=e=>{let{firstUserData:t}=e,{userData:a,loading:l,error:c}=(()=>{let[e,t]=(0,_.useState)(),[a,s]=(0,_.useState)(!0),[l,o]=(0,_.useState)(null),i=(0,n.iD)(),c=(0,b.f4)();return(0,_.useEffect)(()=>{let e=async()=>{try{s(!0);let e=await r.Ay.get("/me",{headers:{Authorization:"Bearer ".concat(i),"X-Internal-Request":F.env.INTERNAL_REQUEST_SECRET,"Accept-Language":c,"x-language":c}});t(e.data)}catch(e){o(e),console.error("Failed to fetch user data:",e)}finally{s(!1)}};i&&e()},[i]),{userData:e,loading:a,error:l}})(),{latestViews:d,isEmpty:u}=(0,m.N)(e=>e.latestViews),[g,h]=(0,_.useState)(!1),[x,f]=(0,_.useState)(!1),{productInFavorites:j}=(0,m.N)(e=>e.favorites),S=(0,N.useRouter)(),{mutate:k,isPending:C}=(0,A.Wn)(),[D,E]=(0,_.useState)(null==t?void 0:t.phoneNumber),[L,B]=(0,_.useState)(null==t?void 0:t.region),R=(0,v.c3)("ProfilePage");(0,_.useEffect)(()=>{!l&&a&&(h(!1),f(!0))},[l,a]);let z=(0,_.useCallback)(e=>{x&&h(e)},[x]),T=[{imageSrc:U.belarusSvg,title:R("belarus"),altName:"Belarus"},{imageSrc:U.kazakhstanSvg,title:R("kazakhstan"),altName:"Kazakhstan"},{imageSrc:U.chinaSvg,title:R("china"),altName:"China"},{imageSrc:U.russiaSvg,title:R("russia"),altName:"Russia"}];return c?void S.push("/login"):(0,s.jsxs)("div",{children:[(0,s.jsx)(i.default,{}),(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:o().profile__inner,children:[(0,s.jsxs)("div",{className:o().profile__user__box,children:[(0,s.jsx)(q,{userData:t||a}),(0,s.jsx)(O,{onDevicesClick:e=>{e.preventDefault()},onPaymentClick:e=>{e.preventDefault()}}),(0,s.jsx)(y.A,{setNeedToSave:z,isLoading:l,userData:t||a,regions:T,onUserDataChange:e=>{console.log("Обновленные данные:",e),E(e.phoneNumber),B(e.region)}}),(0,s.jsx)(V,{phoneNumber:D,region:L,isLoading:l,needToSave:g,onDeleteAccount:()=>{},onLogout:()=>{C||k()}})]}),(0,s.jsxs)("div",{className:o().profile__shops__data,children:[(0,s.jsx)(W,{favoriteCount:j.length,registrationDate:(null==a?void 0:a.registrationDate)||""}),(0,s.jsx)(I,{latestViews:d,isEmpty:u})]}),(0,s.jsx)(p.A,{}),(0,s.jsx)(P,{})]})}),(0,s.jsx)(w.default,{})]})}},43323:e=>{e.exports={help__box:"ProfilePageBottom_help__box__po6h1",help__box__title:"ProfilePageBottom_help__box__title__VU1UZ",help__content:"ProfilePageBottom_help__content__259wP",faq__modal:"ProfilePageBottom_faq__modal__tlGEm",help__content__item:"ProfilePageBottom_help__content__item__bx6SS",delivery__box:"ProfilePageBottom_delivery__box__ShWp4",delivery__box__title:"ProfilePageBottom_delivery__box__title__MWHu6",delivery__list:"ProfilePageBottom_delivery__list__IwEIs",delivery__list__item:"ProfilePageBottom_delivery__list__item__RdcY1",delivery__list__item__image:"ProfilePageBottom_delivery__list__item__image__oD6Q5",descr__box:"ProfilePageBottom_descr__box___IjfL",descr__box__miniDescription:"ProfilePageBottom_descr__box__miniDescription__OU2Dh",descr__box__title:"ProfilePageBottom_descr__box__title__fCESg",price__box:"ProfilePageBottom_price__box__mntOs",descr__box__status:"ProfilePageBottom_descr__box__status__HOkfG",descr__box__byDate:"ProfilePageBottom_descr__box__byDate__YUj5X",delivered:"ProfilePageBottom_delivered__2uAWT",prices:"ProfilePageBottom_prices__thSw_",one__box:"ProfilePageBottom_one__box__mTxvT",price__text:"ProfilePageBottom_price__text__QPXs0",full__price:"ProfilePageBottom_full__price__J0hck",price__by__one:"ProfilePageBottom_price__by__one__u2hyb",price__by__one__start:"ProfilePageBottom_price__by__one__start__eFLMB"}},59619:(e,t,a)=>{"use strict";a.d(t,{A:()=>D});var s=a(95155),_=a(26893),l=a(40055),o=a(12115),i=a(4903),r=a(8767),n=a.n(r),c=a(37220),d=a(83419),u=a(16508),m=a(70358),g=a(33284),p=a(86949),h=a(56671),x=a(63974),f=a(17652),v=a(60584),b=a(9013),P=a(94872),y=a(34540);let j="/countries/belarus.svg",N="/countries/kazakhstan.svg",w="/countries/china.svg",S="/countries/russia.svg",k=(e,t)=>{let a=e.replace(/\D/g,"");switch(t){case"Belarus":return 9===a.length;case"China":return 11===a.length;case"Russia":case"Kazakhstan":return 10===a.length;default:return a.length>=7}},C=e=>{let t=["China","Belarus","Russia","Kazakhstan","other"];if(t.includes(e))return e;let a=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();return t.includes(a)?a:"other"},A=e=>{let{telText:t,isShowForVendor:a,isValidNumber:l,selectedRegion:o,onChangeTelNumber:i}=e,r=C(o.altName),c=(0,f.c3)("ProfilePage.ProfileForm");return(0,s.jsxs)("div",{className:n().phone__input__box,children:[(0,s.jsx)("p",{className:n().input__title,children:c("phoneNumber")}),(0,s.jsx)(_.Vl,{isOnlyShow:!a,currentValue:t,extraClass:n().extra__phone__class,error:l?"":"error",onSetValue:i,numberStartWith:r})]})},D=e=>{let{isVendor:t=!1,onlyShowAddress:a,isShowForOwner:_=!0,userData:r,regions:D,isLoading:E,setNeedToSave:L,onUserDataChange:B,onVendorDataChange:R}=e,[z,F]=(0,o.useState)(""),[U,T]=(0,o.useState)(""),[q,O]=(0,o.useState)(!0),[V,W]=(0,o.useState)([]),[I,M]=(0,o.useState)(null),H=(0,v.f4)(),Z=(0,f.c3)("ProfilePage.ProfileForm"),{updateVendorDetails:Q,updateUserProfile:G,updateVendorAddress:J}=(0,b.d)(),K=(0,P.N)(e=>{var t;return null==(t=e.user.user)?void 0:t.vendorDetails},y.bN);(0,o.useEffect)(()=>{(async()=>{try{let e=await x.Ay.getAll(H);W(e),M(null)}catch(e){M(Z("errorLoadingCAtegoryes")),console.error("Error fetching categories:",e)}})()},[]);let Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[];return e.forEach(e=>{a.push({...e,level:t}),e.children&&e.children.length>0&&a.push(...Y(e.children,t+1))}),a};Y(V);let X=e=>{if(!e)return"other";let t=e.replace(/\D/g,"");return t.startsWith("375")?"Belarus":t.startsWith("86")?"China":t.startsWith("7")?"Russia":"other"},$=e=>e.find(e=>"other"===e.altName)||{imageSrc:"",title:"other",altName:"other"},[ee,et]=(0,o.useState)(()=>{var e;if(t&&(null==r||null==(e=r.vendorDetails)?void 0:e.countries)){let e=r.vendorDetails.countries;if(e.length>1)return $(D);if(1===e.length){let t=e[0].name,a=D.find(e=>e.altName===t||e.title===t);if(a)return a}}if(null==r?void 0:r.region){let e=D.find(e=>e.altName===r.region);if(e)return e}if(null==r?void 0:r.phoneNumber){let e=X(r.phoneNumber),t=D.find(t=>t.altName===e);if(t)return console.log("Detected region from phone:",t.altName),t}return $(D)}),[ea,es]=(0,o.useState)(!1),e_=(0,o.useRef)(null),[el,eo]=(0,o.useState)(!1),[ei,er]=(0,o.useState)(!1),en=(0,m.A)(),[ec,ed]=(0,o.useState)(!1),[eu,em]=(0,o.useState)([]),[eg,ep]=(0,o.useState)(""),[eh,ex]=(0,o.useState)([]),[ef,ev]=(0,o.useState)(!1),[eb,eP]=(0,o.useState)(null);(0,o.useEffect)(()=>{if(!ef)return;let e={phoneNumber:U,region:ee.altName,...z&&{password:z}};t&&R?R({...e,countries:eu,inn:eg,productCategories:eh}):!t&&B&&B(e)},[U,ee.altName,z,t,eu,eg,eh,ef]),(0,o.useEffect)(()=>{var e,t,a,s,_,l;(null==r||null==(e=r.vendorDetails)?void 0:e.inn)&&ep(null==r||null==(s=r.vendorDetails)?void 0:s.inn),(null==r||null==(t=r.vendorDetails)?void 0:t.countries)&&em(null==r||null==(_=r.vendorDetails)?void 0:_.countries.map(e=>({id:e.id,label:e.name,value:e.value,icon:"belarus"===e.value.toLowerCase()?j:"china"===e.value.toLowerCase()?w:"russia"===e.value.toLowerCase()?S:"kazakhstan"===e.value.toLowerCase()?N:""}))),(null==r||null==(a=r.vendorDetails)?void 0:a.productCategories)&&ex(null==r||null==(l=r.vendorDetails)?void 0:l.productCategories.map(e=>({id:e.id,label:e.name,value:e.name,icon:""})))},[r]),(0,o.useEffect)(()=>{er(!0)},[]);let ey=(e,t)=>{let a=e.replace(/\D/g,"");switch(t){case"Belarus":return a.startsWith("375")?a.slice(3):a;case"China":return a.startsWith("86")?a.slice(2):a;case"Russia":case"Kazakhstan":return a.startsWith("7")?a.slice(1):a;default:return a}},ej=(0,o.useCallback)(e=>{ec&&ef&&L(e)},[ec,ef,L]);(0,o.useEffect)(()=>{if(r&&!ec){var e,t;let a=r.region;a&&D.find(e=>e.altName===a)||(a=X(r.phoneNumber||"")),console.log("userData.vendorDetails?.address",null==r||null==(e=r.vendorDetails)?void 0:e.address,"userData.vendorDetaild",null==r?void 0:r.vendorDetails),eP({phoneNumber:r.phoneNumber||"",region:a,address:(null==r||null==(t=r.vendorDetails)?void 0:t.address)||""}),T(r.phoneNumber||""),ed(!0)}},[r,ec,D]),(0,o.useEffect)(()=>{if(!ec||!r||!eb||!ef)return;let e=ey(U,ee.altName),t=ey(eb.phoneNumber,eb.region),a=ee.altName!==eb.region,s=((null==K?void 0:K.address)||"")!==eb.address;ej(a||e!==t||s)},[U,ee,r,ec,ef,eb,ej,null==K?void 0:K.address]),(0,o.useEffect)(()=>{if(r&&!ef){var e,a;let s;if(t&&(null==r?void 0:r.vendorDetails)&&(null==(a=r.vendorDetails)||null==(e=a.countries)?void 0:e.length)>0){let e=r.vendorDetails.countries[0].name;(s=D.find(t=>t.altName===e||t.title===e))&&console.log("Setting vendor region from countries:",s.altName)}if(!s&&r.region&&(s=D.find(e=>e.altName===r.region)),!s&&r.phoneNumber){let e=X(r.phoneNumber);(s=D.find(t=>t.altName===e))&&console.log("Setting region from phone detection:",s.altName)}s||(s=D.find(e=>"other"===e.altName)),s&&et(s)}},[r,D,ef,t]),(0,o.useEffect)(()=>()=>{e_.current&&clearTimeout(e_.current)},[]);let eN=async e=>{try{let t=await g.Rh.post("/auth/verify-recover-password",{email:null==r?void 0:r.email,recoverCode:e},{headers:{"Accept-Language":H}});(0,p.oA)(t.data),h.o.success((0,s.jsxs)("div",{style:{lineHeight:1.5,marginLeft:"10px"},children:[(0,s.jsx)("strong",{style:{display:"block",marginBottom:4,fontSize:"18px"},children:Z("congratulations")}),(0,s.jsx)("span",{children:Z("passwordChangeSuccess")})]}),{style:{background:"#2E7D32"}}),setTimeout(()=>{eo(!1)},1e3),F("")}catch(e){h.o.error(Z("dontChangePassword"))}},ew=[{id:"belarus",label:Z("belarus"),value:"Belarus",icon:j},{id:"kazakhstan",label:Z("kazakhstan"),value:"Kazakhstan",icon:N},{id:"china",label:Z("china"),value:"China",icon:w},{id:"russia",label:Z("russia"),value:"Russia",icon:S}];return(0,o.useEffect)(()=>{if(t&&ef){let e=((e,t)=>{if(1!==e.length)return $(t);let a=e[0].value;return t.find(e=>e.altName.toLowerCase()===a.toLowerCase()||e.title.toLowerCase()===a.toLowerCase())||$(t)})(eu,D);e.altName!==ee.altName&&(et(e),U&&O(k(U.replace(/\D/g,""),C(e.altName))))}},[eu,t,ef,D,ee.altName,U]),(0,s.jsxs)("div",{className:n().create__box,children:[(0,s.jsxs)(c.A,{isOpen:el,onClose:()=>{eo(!1),F("")},children:[(0,s.jsx)("p",{className:"".concat(n().modal__text),children:Z("wannaChangePassword")}),(0,s.jsx)("p",{className:"".concat(n().modal__text__mini),children:Z("enterCodeFromEmail")}),(0,s.jsx)("div",{style:{width:"100%",marginBottom:"10px"},children:(0,s.jsx)(d.A,{length:4,onComplete:eN})})]}),_&&(0,s.jsx)(l.A,{extraClass:n().extra__input,theme:"light",currentValue:z,onSetValue:e=>{F(e),e.length>0&&ev(!0)},isSecret:!0,title:Z("password"),placeholder:Z("createNewPassword"),onBlur:()=>{z.length<=0||(e_.current=setTimeout(()=>{console.log("Таймер сработал: прошло 2 секунды после потери фокуса инпута пароля");try{g.Rh.post("/auth/recover-password",{email:null==r?void 0:r.email,newPassword:z},{headers:{"Accept-Language":H}}),h.o.success(Z("codeInEmail")+(null==r?void 0:r.email)),eo(!0)}catch(e){h.o.error(Z("errorUpdatePassword")),eo(!1)}},2e3))},onFocus:()=>{e_.current&&(clearTimeout(e_.current),e_.current=null,console.log("Таймер отменен: инпут снова получил фокус"))}}),(0,s.jsxs)("div",{className:n().region__box,children:[(0,s.jsx)("p",{style:{cursor:"pointer"},onClick:()=>es(!ea),className:n().input__title,children:Z("regions")}),t?(0,s.jsx)("span",{children:(0,s.jsx)(u.A,{isOnlyShow:!_,extraClass:n().profile__region__dropdown__extra,options:ew,selectedValues:eu,onChange:e=>{console.log("selected countries before change",eu),em(e),ev(!0),console.log("country values",e),console.log("selected countries after change",eu),Q({...K,countries:e.map(e=>({name:e.label,value:e.value}))})},placeholder:Z("selectRegions"),direction:ei&&void 0!==en&&en<1050?"bottom":"right"})}):(0,s.jsx)("div",{className:n().region__box__input,children:(0,s.jsx)(i.E,{regions:D,selectedRegion:ee,listIsOpen:ea,setListIsOpen:es,handleRegionSelect:e=>{ev(!0),et(e),es(!1),O(k(U.replace(/\D/g,""),C(e.altName)))},extraClass:n().profile__region__dropdown})})]}),t&&(0,s.jsx)("div",{style:{margin:"5px 0 5px 0"},className:n().inn__box,children:(0,s.jsx)(l.A,{disabled:!_,extraClass:"".concat(n().extra__input," ").concat(n().extra__input__inn),theme:"light",readOnly:!!a,currentValue:_?(null==K?void 0:K.address)||"":a||"",onSetValue:e=>{J(e),Q({...K,address:e}),console.log("value on set adress",e,"vendorDetails after setter",K),e.length>0&&ev(!0)},title:Z("address"),placeholder:Z("addressPlaceholder")})}),(0,s.jsx)(A,{telText:U,isShowForVendor:_,isValidNumber:q,selectedRegion:ee,onChangeTelNumber:e=>{ef||ev(!0);let t=e.replace(/\D/g,""),a=C(ee.altName),s=k(t,a);G({phoneNumber:t}),T(t),O(s);switch(a){case"Belarus":t.startsWith("375")&&t.slice(3);break;case"China":t.startsWith("86")&&t.slice(2);break;case"Russia":case"Kazakhstan":t.startsWith("7")&&t.slice(1)}}}),t&&(0,s.jsxs)("div",{className:"".concat(n().region__box," ").concat(n().region__box__second),children:[(0,s.jsx)("p",{style:{cursor:"pointer"},onClick:()=>es(!ea),className:n().input__title,children:Z("categoryes")}),(0,s.jsx)(u.A,{extraDropListClass:n().extra_extraDropListClass,showSearchInput:!0,isOnlyShow:!_,extraClass:n().profile__region__dropdown__extra,options:V.map(e=>{var t;return{id:e.id,label:e.name,value:e.name,imageUrl:null==e?void 0:e.imageUrl,children:null==(t=e.children)?void 0:t.map(e=>{var t;return{id:e.id,label:e.name,value:e.name,imageUrl:e.imageUrl,children:null==(t=e.children)?void 0:t.map(e=>{var t;return{id:null==e?void 0:e.id,label:null==e?void 0:e.name,value:null==e?void 0:e.name,imageUrl:null==e?void 0:e.imageUrl,children:null==e||null==(t=e.children)?void 0:t.map(e=>({id:null==e?void 0:e.id,label:null==e?void 0:e.name,value:null==e?void 0:e.name,imageUrl:null==e?void 0:e.imageUrl}))}})}})}}),isCategories:!0,selectedValues:eh,onChange:e=>{ex(e),ev(!0),Q({...K,productCategories:e.map(e=>({id:null==e?void 0:e.id.toString(),name:null==e?void 0:e.value,icon:null==e?void 0:e.icon}))})},placeholder:Z("selectCategoryes"),direction:ei&&void 0!==en&&en<1050?"bottom":"right"})]}),t&&(0,s.jsx)("div",{style:{margin:"5px 0 0px 0"},className:n().inn__box,children:(0,s.jsx)(l.A,{disabled:!_,extraClass:"".concat(n().extra__input," ").concat(n().extra__input__inn),theme:"light",currentValue:eg,onSetValue:e=>{ep(e),ev(!0),Q({...K,inn:e})},title:Z("inn"),placeholder:Z("innPlaceholder")})})]})}},75543:e=>{e.exports={avatar:"Avatar_avatar__hsAwO",avatar__image:"Avatar_avatar__image__FoJaG",avatar__overlay:"Avatar_avatar__overlay__B2btR",avatar__icon:"Avatar_avatar__icon__yOxxk",avatar__spinner:"Avatar_avatar__spinner__4LLGh",spin:"Avatar_spin__Dw32v",avatar__input:"Avatar_avatar__input__9bMvQ"}}}]);