(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6400],{2183:(e,t,r)=>{"use strict";r.d(t,{H:()=>J,default:()=>K});var a=r(95155),n=r(12115),i=r(19250),o=r.n(i),l=r(75081),s=r(29795),_=r(40055),c=r(56672),d=r(66766),u=r(86364),p=r(44481),m=r.n(p),g=r(42815),h=r(37220);let x=()=>{let[e,t]=(0,n.useState)(null),[r,a]=(0,n.useState)(!1);return{modalImage:e,isModalOpen:r,openModal:(0,n.useCallback)(e=>{t(e),a(!0)},[]),closeModal:(0,n.useCallback)(()=>{a(!1),setTimeout(()=>t(null),300)},[])}};var v=r(70358),w=r(17652),C=r(9013),y=r(94872);let f="/vopros.svg",b=(0,n.memo)(e=>{let{pricesArray:t,onSetPricesArray:r,pricesError:i="",inputType:o,currentLanguage:l,dropdownPricesOptions:s=[],canCreateNewOption:u=[]}=e,{updateCharacteristic:p,setCharacteristics:b,addCharacteristic:j,removeCharacteristic:N,updateDelivery:D,setDelivery:E,addDelivery:I,removeDelivery:S,updatePackaging:P,setPackaging:T,addPackaging:A,removePackaging:k,updatePriceInfo:F,setError:R,clearErrors:M,setCurrentLanguage:q}=(0,C.d)(),V=(0,y.N)(e=>e.multiLanguageCardPriceData[l]),z=(0,y.N)(e=>e.multiLanguageCardPriceData.errors[l]),L=(0,y.N)(e=>e.multiLanguageCardPriceData.currentLanguage),[O,B]=(0,n.useState)(t||[]),[W,U]=(0,n.useState)(0),[H,G]=(0,n.useState)(0),[K,Q]=(0,n.useState)(0),Z=(0,w.c3)("CreateCardPriceElementsText");(0,n.useEffect)(()=>{l!==L&&q(l)},[l,L,q]),(0,n.useEffect)(()=>{U(e=>e+1),G(e=>e+1),Q(e=>e+1)},[l]),(0,n.useEffect)(()=>{t&&JSON.stringify(t)!==JSON.stringify(O)&&B(t)},[t]);let Y=V.characteristics.map(e=>[e.title,e.characteristic]),X=V.delivery.map(e=>[e.title,e.daysDelivery]),$=V.packaging.map(e=>[e.title,e.price]),{modalImage:ee,isModalOpen:et,openModal:er,closeModal:ea}=x(),en=(0,v.A)();(0,n.useEffect)(()=>{console.log("currentData",V)},[V]);let ei=(()=>{if(!o||0===s.length)return[];let e=[],t=0;return o.forEach((r,a)=>{"dropdown"===r&&t<s.length?(e[a]=s[t],t++):e[a]=[]}),e})(),eo=(()=>{if(!o||0===u.length)return[];let e=[],t=0;return o.forEach((r,a)=>{"dropdown"===r&&t<u.length?(e[a]=u[t],t++):e[a]=!1}),e})();return(0,a.jsxs)("div",{className:m().create__prices__box,children:[(0,a.jsx)(h.A,{isOpen:et,onClose:ea,children:ee&&(0,a.jsx)(d.default,{className:"".concat(m().drop__extra__image," ").concat(m().drop__extra__image__modal),src:ee,alt:"Help image",width:1e3,height:1e3})}),(0,a.jsxs)("div",{className:m().rows__inputs__box,children:[(0,a.jsxs)("div",{className:m().rows__inputs__box__inner,children:[(0,a.jsxs)("div",{className:"".concat(m().create__label__title__box),children:[(0,a.jsx)("p",{className:"".concat(m().create__label__title),children:Z("pricesList")}),(0,a.jsx)(c.A,{direction:en&&en<768?"bottom":"right",safeAreaEnabled:!0,positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(m().arrow__none),title:(0,a.jsx)(d.default,{src:f,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>er(J.prices),src:J.prices,alt:"question",width:300,height:300},1)]})]}),(0,a.jsx)(g.A,{inputsInRowCount:5,maxRows:5,dropdownOptions:ei,canCreateNewOption:eo,inputType:o,initialRowsCount:1,idNames:["elementCount","originalPrice","priceWithDiscount","currency","unit"],titles:[Z("elementCount"),Z("originalPrice"),Z("priceWithDiscount"),Z("currency"),Z("unit")],rowsInitialValues:O,onSetValue:(e,t,a)=>{let n=[...O];n[e]||(n[e]=[,,,,,].fill("")),n[e][t]=a,B(n),r(n.filter(e=>e.some(e=>e.trim())).map(e=>({quantity:e[0]||"",priceWithoutDiscount:e[1]||"",priceWithDiscount:e[2]||"",currency:e[3]||"",unit:e[4]||"",value:parseFloat(e[2]||e[1]||"0")})))},onRowsChange:e=>{B(e),r(e.filter(e=>e.some(e=>e.trim())).map(e=>({quantity:e[0]||"",priceWithoutDiscount:e[1]||"",priceWithDiscount:e[2]||"",currency:e[3]||"",unit:e[4]||"",value:parseFloat(e[2]||e[1]||"0")})))},errorMessage:i,minFilledRows:1})]}),(0,a.jsxs)("div",{className:"".concat(m().rows__inputs__box__inner," ").concat(m().rows__inputs__box__inner__description),children:[(0,a.jsxs)("div",{className:"".concat(m().create__label__title__box),children:[(0,a.jsx)("p",{className:"".concat(m().create__label__title),children:Z("characteristickTable")}),(0,a.jsx)(c.A,{direction:en&&en<768?"bottom":"right",safeAreaEnabled:!0,positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(m().arrow__none),title:(0,a.jsx)(d.default,{src:f,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>er(J.charactersTable),src:J.charactersTable,alt:"question",width:300,height:300},1)]})]}),(0,a.jsx)(g.A,{inputsInRowCount:2,maxRows:20,inputType:["text","textarea"],textAreaProps:{minRows:1,maxRows:5,autoResize:!0},extraClasses:[m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra,m().rows__inputs__box__inner__description__extra],initialRowsCount:1,idNames:["title-characteristic","characteristic-characteristic"],titles:[Z("title"),Z("characteristic")],rowsInitialValues:Y,onSetValue:(e,t,r)=>{p({language:l,index:e,field:0===t?"title":"characteristic",value:r})},onRowsChange:e=>{b({language:l,characteristics:e.map(e=>({title:e[0]||"",characteristic:e[1]||""}))})},errorMessage:z.characteristicsError,minFilledRows:1},"characteristics-".concat(W))]})]}),(0,a.jsxs)("div",{className:m().right__box,children:[(0,a.jsxs)("div",{className:m().seller__date__box,children:[(0,a.jsxs)("div",{className:m().seller__title,children:[(0,a.jsxs)("p",{className:m().seller__title__text,children:[Z("infoAboutPrices")," "]}),(0,a.jsx)(c.A,{direction:en&&en<768?"bottom":"left",safeAreaEnabled:!0,extraClass:"".concat(m().drop__extra),positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(m().arrow__none),title:(0,a.jsx)(d.default,{src:f,alt:"question",width:27,height:27}),items:[(0,a.jsx)(d.default,{src:J.saleDate,className:m().drop__extra__image__modal__second,alt:"question",width:600,onClick:()=>er(J.saleDate),height:600},1)]})]}),(0,a.jsxs)("div",{className:m().seller__date__box__inner,children:[(0,a.jsxs)("div",{className:m().seller__date__box__inner__date,children:[(0,a.jsx)("p",{className:m().seller__date__box__inner__date__text,children:Z("daysCountBeforeSale")}),(0,a.jsx)(_.A,{idForLabel:"cy-daysBeforeSale",inputType:"number",currentValue:V.priceInfo.daysBeforeSale,onSetValue:e=>{F({language:l,field:"daysBeforeSale",value:e}),z.saleDateError&&(e=>{if(!e.trim())return R({language:l,errorType:"saleDateError",error:Z("daysBeforeSale")});let t=parseInt(e);return isNaN(t)||t<=0?R({language:l,errorType:"saleDateError",error:Z("daysBeforeSaleNotMinus")}):R({language:l,errorType:"saleDateError",error:""})})(e)},theme:"lightBlue",placeholder:Z("daysCountBeforeSalePlaceholder"),errorValue:z.saleDateError})]}),(0,a.jsxs)("div",{className:m().seller__date__box__inner__date,children:[(0,a.jsx)("p",{className:m().seller__date__box__inner__date__text,children:Z("minimalVolumeTitle")}),(0,a.jsx)(_.A,{idForLabel:"cy-minimalVolume",inputType:"number",currentValue:V.priceInfo.minimalVolume,onSetValue:e=>{F({language:l,field:"minimalVolume",value:e}),z.minVolumeError&&(e.trim()?R({language:l,errorType:"minVolumeError",error:""}):R({language:l,errorType:"minVolumeError",error:Z("minimalVolume")}))},theme:"lightBlue",placeholder:Z("minimalVolumePlaceholder"),errorValue:z.minVolumeError})]})]})]}),(0,a.jsxs)("div",{className:m().del__box,children:[(0,a.jsxs)("div",{className:m().seller__title,children:[(0,a.jsx)("p",{className:m().seller__title__text,children:Z("deliveryInfo")}),(0,a.jsx)(c.A,{direction:en&&en<768?"bottom":"left",safeAreaEnabled:!0,extraClass:"".concat(m().drop__extra),positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(m().arrow__none),title:(0,a.jsx)(d.default,{src:f,alt:"question",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>er(J.delivery),src:J.delivery,alt:"question",width:300,height:300},1)]})]}),(0,a.jsx)(g.A,{extraButtonMinusClass:m().minus__extra,extraClasses:[m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del],initialRowsCount:1,maxRows:5,idNames:["title-delivery","daysDelivery-delivery"],rowsInitialValues:X,onSetValue:(e,t,r)=>{D({language:l,index:e,field:0===t?"title":"daysDelivery",value:r})},onRowsChange:e=>{E({language:l,delivery:e.map(e=>({title:e[0]||"",daysDelivery:e[1]||""}))})},titles:[Z("title"),Z("daysDelivery")],errorMessage:z.deliveryError,minFilledRows:1},"delivery-".concat(H))]}),(0,a.jsxs)("div",{className:m().package__box,children:[(0,a.jsxs)("div",{className:m().seller__title,children:[(0,a.jsx)("p",{className:m().seller__title__text,children:Z("packagingOptions")}),(0,a.jsx)(c.A,{direction:en&&en<768?"bottom":"left",safeAreaEnabled:!0,extraClass:"".concat(m().drop__extra),positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(m().arrow__none),title:(0,a.jsx)(d.default,{src:f,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>er(J.delivery),src:J.delivery,alt:"vopros",width:300,height:300},1)]})]}),(0,a.jsx)(g.A,{idNames:["title-packaging","price-packaging"],inputType:["text","number"],extraButtonMinusClass:m().minus__extra,extraClasses:[m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del,m().rows__extra__del],initialRowsCount:1,maxRows:5,onSetValue:(e,t,r)=>{P({language:l,index:e,field:0===t?"title":"price",value:r})},rowsInitialValues:$,onRowsChange:e=>{T({language:l,packaging:e.map(e=>({title:e[0]||"",price:e[1]||""}))})},titles:[Z("title"),Z("price")],errorMessage:z.packagingError,minFilledRows:1},"packaging-".concat(K))]})]})]})});b.displayName="CreateCardPriceElements";var j=r(16385),N=r.n(j),D=r(98935);let E="/vopros.svg",I=e=>{let{descriptionError:t="",currentDynamicLang:r}=e,{setDescriptionOne:i,setAdditionalDescription:o}=(0,C.d)(),{descriptions:l}=(0,y.N)(e=>e.multilingualDescriptions),[s,_]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),m=e=>0===e.replace(/^#\s*[^\n]*\s*$/gm,"").trim().length;(0,n.useEffect)(()=>{let e=l[r].description;t&&u&&m(e)?_(!0):_(!1)},[t,u,r,l]);let{modalImage:g,isModalOpen:v,openModal:f,closeModal:b}=x(),j=(0,w.c3)("CreateDescription"),I=(0,n.useRef)([]);return(0,n.useEffect)(()=>{I.current.push(r)},[r]),(0,a.jsxs)("div",{className:N().create__descriptions__box,children:[(0,a.jsx)(h.A,{isOpen:v,onClose:b,children:g&&(0,a.jsx)(d.default,{className:"".concat(N().drop__extra__image," ").concat(N().drop__extra__image__modal),src:g,alt:"Help image",width:1e3,height:1e3})}),(0,a.jsxs)("div",{className:"".concat(N().left),children:[(0,a.jsxs)("div",{className:"".concat(N().left__top__descr," ").concat(s?N().has__error:""),children:[(0,a.jsxs)("div",{className:"".concat(N().descr__el__title),children:[(0,a.jsxs)("p",{className:"".concat(N().descr__title),children:[j("descriptionPlaceholder")," ",(0,a.jsx)("span",{className:"".concat(N().required," ").concat(s?N().required__error:""),children:"*"})]}),(0,a.jsx)(c.A,{direction:"bottom",safeAreaEnabled:!0,extraClass:"".concat(N().drop__extra),positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(N().arrow__none),title:(0,a.jsx)(d.default,{src:E,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>f(J.description),src:J.description,alt:"vopros",width:300,height:300},1)]})]}),(0,a.jsx)("div",{className:N().editor__wrapper,onFocus:()=>{p(!0)},onBlur:()=>{let e=l[r].description;t&&m(e)&&_(!0)},children:(0,a.jsx)(D.A,{extraClass:"".concat(N().editor__extra__text),rows:18,onSetValue:e=>i({language:r,description:e}),currentValue:l[r].description,placeholder:j("writeDescription"),theme:"superWhite"})}),s&&(0,a.jsx)("p",{className:N().error__message,children:t})]}),(0,a.jsxs)("div",{className:"".concat(N().left__bottom__descr),children:[(0,a.jsxs)("div",{className:"".concat(N().descr__el__title),children:[(0,a.jsxs)("p",{className:"".concat(N().descr__title),children:[j("secondDescr"),(0,a.jsxs)("span",{className:N().optional,children:["(",j("secondDescrSpan"),")"]})]}),(0,a.jsx)(c.A,{direction:"left",safeAreaEnabled:!0,extraClass:"".concat(N().drop__extra," ").concat(N().second__drop__extra),positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(N().arrow__none),title:(0,a.jsx)(d.default,{src:E,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>f(J.description),src:J.description,alt:"vopros",width:300,height:300},1)]})]}),(0,a.jsx)(D.A,{theme:"superWhite",rows:15,extraClass:"".concat(N().editor__extra__text),onSetValue:e=>o({language:r,additionalDescription:e}),currentValue:l[r].additionalDescription,placeholder:j("writeSecondDescr")})]})]})]})};var S=r(7915),P=r.n(S);let T=e=>{let{values:t,onChange:r}=e,{modalImage:n,isModalOpen:i,openModal:o,closeModal:l}=x(),s=(0,v.A)(),_=(0,w.c3)("CreateFaqCard");return(0,a.jsxs)("div",{className:"".concat(P().create),children:[(0,a.jsx)(h.A,{isOpen:i,onClose:l,children:n&&(0,a.jsx)(d.default,{className:"".concat(P().drop__extra__image," ").concat(P().drop__extra__image__modal),src:n,alt:"Help image",width:1e3,height:1e3})}),(0,a.jsxs)("div",{className:"".concat(P().descr__el__title," ").concat(P().descr__el__title__right),children:[(0,a.jsx)("p",{className:"".concat(P().descr__title),children:_("faqTitle")}),(0,a.jsx)(c.A,{direction:s&&s<768?"bottom":"right",safeAreaEnabled:!0,extraClass:"".concat(P().drop__extra),positionIsAbsolute:!1,trigger:"hover",arrowClassName:"".concat(P().arrow__none),title:(0,a.jsx)(d.default,{src:"/vopros.svg",alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{onClick:()=>{o(J.faq)},src:J.faq,alt:"vopros",width:300,height:300},1)]})]}),(0,a.jsx)(g.A,{idNames:["cy-question","cy-answer"],inputsInRowCount:2,maxRows:15,initialRowsCount:1,titles:[_("question"),_("answer")],controlled:!0,externalValues:t,onSetValue:(e,a,n)=>{if(!r)return;let i=t?t.map(e=>[...e]):[];i[e]||(i[e]=[]),i[e][a]=n,console.log("newValues",i),r(i)},onRowsChange:r})]})};var A=r(14979),k=r.n(A),F=r(53973),R=r(48213);let M=e=>{let{initialProducts:t,onUpdateProductsSet:r,maxProducts:i=10,disabled:o=!1,removeButtonText:l="Убрать",showAddButton:s=!0}=e,[_,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(()=>t?(Array.isArray(t),new Set(t)):new Set);(0,n.useEffect)(()=>{t&&u((Array.isArray(t),new Set(t)))},[t]),(0,n.useEffect)(()=>{null==r||r(d)},[d,r]),(0,n.useEffect)(()=>{console.log("activeProductsFromModal",d)},[d]);let p=d.size<i&&!o;return(0,a.jsxs)("div",{className:k().create__similar__products__box,children:[(0,a.jsx)(h.A,{extraClass:k().drop__extra__modal__catalog,isOpen:_,onClose:()=>c(!1),children:(0,a.jsx)(F.A,{onPreventCardClick:e=>{o||u(t=>t.size>=i?(console.warn("Максимальное количество продуктов: ".concat(i)),t):Array.from(t).some(t=>t.id===e.id)?t:new Set([...t,e]))},canCreateNewProduct:!1,specialRoute:"/me/products-summary"})}),(0,a.jsxs)("ul",{id:"cy-create-similar-products-list",className:"".concat(k().list__items),children:[s&&p&&(0,a.jsxs)("li",{id:"cy-create-similar-products-plus-button",onClick:()=>{o||d.size>=i||c(!0)},className:"".concat(k().cardsCatalog__create," ").concat(o?k().disabled:""),children:[(0,a.jsx)("div",{className:"".concat(k().cardsCatalog__create__image),children:"+"}),(0,a.jsx)("div",{className:"".concat(k().cardsCatalog__create__text)}),(0,a.jsx)("div",{className:"".concat(k().cardsCatalog__create__text)}),(0,a.jsx)("div",{className:"".concat(k().cardsCatalog__create__button)})]}),Array.from(d).map(e=>(0,a.jsx)(R.A,{specialButtonText:l,isLoading:!1,id:e.id,onPreventCardClick:()=>{!o&&u(t=>{let r=new Set(t);for(let t of r)if(t.id===e.id){r.delete(t);break}return r})},title:e.title,price:e.originalPrice,discount:e.discount,previewImageUrl:e.previewImageUrl,discountedPrice:e.discountedPrice,deliveryMethod:e.deliveryMethod,fullProduct:e},e.id))]})]})};var q=r(20447),V=r.n(q),z=r(63974),L=r(60584);let O=e=>{let{initialProductCategory:t,onSetCategory:r}=e,[i,o]=(0,n.useState)(t||null),[l,s]=(0,n.useState)(""),[_,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)([]),[p,m]=(0,n.useState)(!0),[g,h]=(0,n.useState)(null),[x,v]=(0,n.useState)(new Set),C=(0,n.useRef)(null),y=(0,w.c3)("CreateCardProductCategory"),f=(0,L.f4)();(0,n.useEffect)(()=>{(async()=>{try{m(!0);let e=await z.Ay.getAll(f);u(e),h(null)}catch(e){h(y("errorLoadingCategoryes")),console.error("Error fetching categories:",e)}finally{m(!1)}})()},[]),(0,n.useEffect)(()=>{r(i)},[i,r]),(0,n.useEffect)(()=>{let e=e=>{_&&C.current&&!C.current.contains(e.target)&&c(!1)};if(_)return window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("scroll",e,!0)}},[_]);let b=(e,t)=>{if(!t)return!0;let r=t.toLowerCase();return!!e.name.toLowerCase().includes(r)||!!e.children&&e.children.length>0&&e.children.some(e=>b(e,t))},j=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=[];for(let n of e){let e=[...r,n.id.toString()];if(b(n,t)&&(a.push(e),n.children&&n.children.length>0)){let r=j(n.children,t,e);a.push(...r)}}return a},N=(e,t)=>!t||b(e,t);(0,n.useEffect)(()=>{if(l){let e=j(d,l),t=new Set;e.forEach(e=>{e.forEach(e=>{t.add(e)})}),v(t)}},[l,d]);let D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.filter(e=>N(e,l)).map(e=>{let r=x.has(e.id.toString()),n=e.children&&e.children.length>0;return(0,a.jsxs)("div",{className:V().cat__categoryGroup,children:[(0,a.jsxs)("button",{type:"button",onClick:()=>{o(e),e.children&&e.children.length>0?(e=>{let t=new Set(x);t.has(e)?t.delete(e):t.add(e),v(t)})(e.id.toString()):(s(""),c(!1),v(new Set))},className:"".concat(V().cat__dropdownItem," ").concat(V()["cat__dropdownItem--level".concat(t)]," ").concat((null==i?void 0:i.id)===e.id?V()["cat__dropdownItem--selected"]:""),style:{paddingLeft:"".concat(12+20*t,"px")},children:[t>0&&(0,a.jsx)("span",{className:V().cat__levelIndicator,children:"└".repeat(t)}),n&&(0,a.jsx)("span",{className:"".concat(V().cat__expandIcon," ").concat(r?V()["cat__expandIcon--expanded"]:""),children:"▶"}),e.imageUrl&&(0,a.jsx)("img",{src:e.imageUrl,alt:e.name,className:V().cat__dropdownImage}),(0,a.jsx)("span",{className:V().cat__dropdownName,children:e.name}),(null==i?void 0:i.id)===e.id&&(0,a.jsx)("span",{className:V().cat__checkmark,children:"✓"})]}),n&&r&&(0,a.jsx)("div",{className:V().cat__childrenContainer,children:D(e.children,t+1)})]},e.id)})};return p?(0,a.jsx)("div",{className:V().cat__box,children:(0,a.jsx)("div",{className:V().cat__loading,children:y("loadingCategories")})}):g?(0,a.jsx)("div",{className:V().cat__box,children:(0,a.jsx)("div",{className:V().cat__error,children:g})}):(0,a.jsxs)("div",{className:V().cat__box,children:[(0,a.jsx)("div",{className:V().cat__selected,children:i?(0,a.jsxs)("div",{className:V().cat__selectedItem,children:[i.imageUrl&&(0,a.jsx)("img",{src:i.imageUrl,alt:i.name,className:V().cat__image}),(0,a.jsx)("span",{className:V().cat__name,children:i.name}),(0,a.jsx)("button",{type:"button",onClick:()=>{o(null)},className:V().cat__remove,"aria-label":"removeCategory"})]}):(0,a.jsx)("p",{className:V().cat__empty,children:y("emptyCategory")})}),(0,a.jsx)("div",{className:V().cat__add,children:(0,a.jsxs)("div",{className:V().cat__searchWrapper,children:[(0,a.jsx)("input",{type:"text",id:"cy-create-card-product-category-search",placeholder:y("foundCategoryProcessing"),value:l,onChange:e=>s(e.target.value),onFocus:()=>c(!0),className:V().cat__search}),_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{id:"cy-create-card-product-category-backdrop-to-open",className:V().cat__backdrop,onClick:()=>{c(!1),v(new Set)}}),(0,a.jsx)("div",{ref:C,id:"cy-create-card-product-category-dropdown",className:V().cat__dropdown,children:0===d.length?(0,a.jsx)("div",{className:V().cat__noResults,children:y("categoryNotFound")}):l&&0===((e,t)=>{if(!t)return e.length;let r=0;for(let a of e)N(a,t)&&r++;return r})(d,l)?(0,a.jsx)("div",{className:V().cat__notFound,children:(0,a.jsxs)("div",{className:V().cat__notFoundContent,children:[(0,a.jsx)("span",{className:V().cat__notFoundIcon,children:"\uD83D\uDD0D"}),(0,a.jsx)("span",{className:V().cat__notFoundText,children:y("notFoundCategories")}),(0,a.jsx)("span",{className:V().cat__notFoundSubtext,children:y("tryChangeSearch")})]})}):(0,a.jsx)("div",{className:V().cat__dropdownList,children:D(d)})})]})]})})]})};var B=r(71747),W=r(56671);let U=async e=>{var t,r,a,n,i,o,l,s,_,c,d,u,p,m,g,h,x,v,w,C,y,f,b,j,N,D,E;let{cardObjectForOthers:I,faqMatrixForOthers:S,similarProducts:P,selectedCategory:T,langFromPathname:A,currentLangState:k,cardTitle:F,descriptions:R,multyLangObjectForPrices:M,uploadedFiles:q,remainingInitialImages:V,objectRemainingInitialImages:z,pricesArray:L,pathname:O,initialData:U}=e;console.log("--- submitFormCardData props ---"),console.log("cardObjectForOthers:",I),console.log("faqMatrixForOthers:",S),console.log("similarProducts:",P),console.log("selectedCategory:",T),console.log("langFromPathname:",A),console.log("currentLangState:",k),console.log("cardTitle:",F),console.log("descriptions:",R),console.log("multyLangObjectForPrices:",M),console.log("uploadedFiles:",q),console.log("remainingInitialImages:",V),console.log("objectRemainingInitialImages:",z),console.log("pricesArray:",L);let H=L.map(e=>({...e,quantity:(e=>{let t=e.trim(),r=[];for(let e of["-","–","—","––"])if(t.includes(e)){r=t.split(e).map(e=>e.trim());break}return 2===r.length?{from:parseInt(r[0])||0,to:parseInt(r[1])||0}:{from:parseInt(t)||0,to:null}})(e.quantity)}));console.log("--- Processed data ---"),console.log("pricesArrayForSubmit:",H);let G=O.match(/\d+$/)&&((null==U?void 0:U.id)!==null||(null==U?void 0:U.id)!==void 0),J=(0,B.iD)(),K={ru:(null==(t=I.ru)?void 0:t.title)||("ru"===A?F:""),en:(null==(r=I.en)?void 0:r.title)||("en"===A?F:""),zh:(null==(a=I.zh)?void 0:a.title)||("zh"===A?F:"")},Q={ru:(null==(n=R.ru)?void 0:n.description)||("ru"===A?null==(i=R.ru)?void 0:i.description:null),en:(null==(o=R.en)?void 0:o.description)||("en"===A?null==(l=R.en)?void 0:l.description:null),zh:(null==(s=R.zh)?void 0:s.description)||("zh"===A?null==(_=R.zh)?void 0:_.description:null)},Z={ru:(null==(c=R.ru)?void 0:c.furtherDescription)||(null==(d=R.ru)?void 0:d.additionalDescription)||null,en:(null==(u=R.en)?void 0:u.furtherDescription)||(null==(p=R.en)?void 0:p.additionalDescription)||null,zh:(null==(m=R.zh)?void 0:m.furtherDescription)||(null==(g=R.zh)?void 0:g.additionalDescription)||null},Y=H.map(e=>{var t,r;return{quantityFrom:"object"==typeof e.quantity?e.quantity.from.toString():e.quantity,quantityTo:"object"==typeof e.quantity?null==e||null==(r=e.quantity)||null==(t=r.to)?void 0:t.toString():e.quantity,currency:e.currency,unit:e.unit,price:parseFloat(e.priceWithoutDiscount),discount:e.priceWithDiscount&&e.priceWithoutDiscount?Math.round((parseFloat(e.priceWithoutDiscount)-parseFloat(e.priceWithDiscount))/parseFloat(e.priceWithoutDiscount)*100):0}});console.log("цена от и до:",Y);let X=Array.from(P).map(e=>e.id),$=(null==(x=M[A])||null==(h=x.characteristics)?void 0:h.map((e,t)=>{var r,a,n,i,o,l,s,_,c,d,u,p,m,g,h,x,v,w;return{name:null==e?void 0:e.title,nameTranslations:{ru:null==M||null==(n=M.ru)||null==(a=n.characteristics)||null==(r=a[t])?void 0:r.title,en:null==M||null==(l=M.en)||null==(o=l.characteristics)||null==(i=o[t])?void 0:i.title,zh:null==M||null==(c=M.zh)||null==(_=c.characteristics)||null==(s=_[t])?void 0:s.title},value:e.characteristic,valueTranslations:{ru:null==M||null==(p=M.ru)||null==(u=p.characteristics)||null==(d=u[t])?void 0:d.characteristic,en:null==M||null==(h=M.en)||null==(g=h.characteristics)||null==(m=g[t])?void 0:m.characteristic,zh:null==M||null==(w=M.zh)||null==(v=w.characteristics)||null==(x=v[t])?void 0:x.characteristic}}}))||[],ee=((null==(v=S[A])?void 0:v.map((e,t)=>{var r,a,n,i,o,l,s,_,c,d,u,p;return{question:(null==e?void 0:e[0])||"",questionTranslations:{ru:(null==S||null==(a=S.ru)||null==(r=a[t])?void 0:r[0])||"",en:(null==S||null==(i=S.en)||null==(n=i[t])?void 0:n[0])||"",zh:(null==S||null==(l=S.zh)||null==(o=l[t])?void 0:o[0])||""},answer:(null==e?void 0:e[1])||"",answerTranslations:{ru:(null==S||null==(_=S.ru)||null==(s=_[t])?void 0:s[1])||"",en:(null==S||null==(d=S.en)||null==(c=d[t])?void 0:c[1])||"",zh:(null==S||null==(p=S.zh)||null==(u=p[t])?void 0:u[1])||""}}}))||[]).filter(e=>e.question&&e.answer),et=(null==(C=M[A])||null==(w=C.delivery)?void 0:w.map((e,t)=>{var r,a,n,i,o,l,s,_,c,d,u,p,m,g,h,x,v,w;return{name:(null==e?void 0:e.title)||"Default Name",nameTranslations:{ru:(null==M||null==(n=M.ru)||null==(a=n.delivery)||null==(r=a[t])?void 0:r.title)||"",en:(null==M||null==(l=M.en)||null==(o=l.delivery)||null==(i=o[t])?void 0:i.title)||"",zh:(null==M||null==(c=M.zh)||null==(_=c.delivery)||null==(s=_[t])?void 0:s.title)||""},value:e.daysDelivery,valueTranslations:{ru:(null==M||null==(p=M.ru)||null==(u=p.delivery)||null==(d=u[t])?void 0:d.daysDelivery)||"",en:(null==M||null==(h=M.en)||null==(g=h.delivery)||null==(m=g[t])?void 0:m.daysDelivery)||"",zh:(null==M||null==(w=M.zh)||null==(v=w.delivery)||null==(x=v[t])?void 0:x.daysDelivery)||""}}}))||[],er=(null==(f=M[A])||null==(y=f.packaging)?void 0:y.map((e,t)=>{var r,a,n,i,o,l,s,_,c,d;return{name:(null==e?void 0:e.title)||"",nameTranslations:{ru:(null==M||null==(n=M.ru)||null==(a=n.packaging)||null==(r=a[t])?void 0:r.title)||"",en:(null==M||null==(l=M.en)||null==(o=l.packaging)||null==(i=o[t])?void 0:i.title)||"",zh:(null==M||null==(c=M.zh)||null==(_=c.packaging)||null==(s=_[t])?void 0:s.title)||""},price:parseFloat((null==(d=e.price)?void 0:d.toString())||"0"),priceUnit:H[0].currency||"RUB"}}))||[],ea=[];V.forEach((e,t)=>{if(G){var r;let a=null==U||null==(r=U.media)?void 0:r.find(t=>t.url===e);a&&ea.push({id:null==a?void 0:a.id,position:t})}});let en={title:K[A||"en"]||F,titleTranslations:K,mainDescription:Q[A||"en"],mainDescriptionTranslations:Q,furtherDescription:(null==Z?void 0:Z[A||"en"])||"",furtherDescriptionTranslations:Z,categoryId:(null==T?void 0:T.id)||0,deliveryMethodIds:[1],prices:Y,similarProducts:X,characteristics:$,faq:ee,deliveryMethodDetails:et,packageOptions:er,minimumOrderQuantity:parseInt((null==(j=M[A||"en"])||null==(b=j.priceInfo)?void 0:b.minimalVolume)||"1"),discountExpirationDate:parseInt((null==(D=M[A||"en"])||null==(N=D.priceInfo)?void 0:N.daysBeforeSale)||"30"),...G&&{oldProductMedia:ea.length>0?ea:[]}},ei=new FormData,eo=new Blob([JSON.stringify(en)],{type:"application/json"});ei.append("data",eo),q.forEach(e=>{e instanceof File&&ei.append("productMedia",e)}),console.log("--- Final data object ---"),console.log("Data to be sent:",JSON.stringify(en,null,2)),console.log("Product media files count:",q.length),console.log("Old product media:",ea);let el=G?"".concat("https://exporteru.com","/api/v1/products/").concat(null==U?void 0:U.id):"".concat("https://exporteru.com","/api/v1/products");try{let e=await fetch(el,{method:G?"PUT":"POST",headers:{Authorization:"Bearer ".concat(J)},body:ei});if(!e.ok){let t=await e.json();console.log("full res",e,"response.body",e.body);let r=(null==t||null==(E=t.errors)?void 0:E.message)||(null==t?void 0:t.message)||"HTTP error! status: ".concat(e.status);throw W.o.error(r),console.log("errorData in !response.ok",t,"response",e),console.log("сообщение об ошибке",r),Error("HTTP error! status: ".concat(e.status,", message: ").concat(r))}let t=await e.json();return console.log("--- Submission successful ---"),console.log("Result:",t),console.log("--- End of submitFormCardData logs ---"),t}catch(e){throw console.error("--- Submission failed ---"),console.error("Error:",e),console.log("--- End of submitFormCardData logs ---"),e}};var H=r(35695);let G="/vopros.svg",J={title:"/create/help1.jpg",productImages:"/create/help2.jpg",prices:"/create/help3.jpg",saleDate:"/create/help4.jpg",delivery:"/create/help5.jpg",charactersTable:"/create/help6.jpg",description:"/create/help7.jpg",companyDescription:"/create/help8.jpg",faq:"/create/help9.jpg",similarProducts:"/create/help10.jpg"},K=e=>{let{initialData:t}=e,[r,i]=(0,n.useState)(!0),p=(0,H.useRouter)(),{cardObjectForOthers:m,faqMatrixForOthers:g,setCardObjectForOthers:f,setFaqMatrixForOthers:j}=(e=>{let t=(0,H.usePathname)().split("/")[1],r=(0,L.f4)(),a=t||r,i=["ru","en","zh"],[o,l]=(0,n.useState)(()=>((e,t,r)=>e.reduce((e,a)=>{var n,i,o;return{...e,[a]:{title:a===t?(null==r?void 0:r.title)||"":(null==r?void 0:r.titleTranslations)&&(null==r?void 0:r.titleTranslations[a])||"",aboutVendor:(null==r?void 0:r.aboutVendor)?{mainDescription:a===t?r.aboutVendor.mainDescription||"":r.aboutVendor.mainDescriptionTranslations[a],furtherDescription:a===t?r.aboutVendor.furtherDescription||"":r.aboutVendor.furtherDescriptionTranslations[a],mainDescriptionTranslations:r.aboutVendor.mainDescriptionTranslations,furtherDescriptionTranslations:r.aboutVendor.furtherDescriptionTranslations,media:r.aboutVendor.media||[]}:void 0,category:null==r?void 0:r.category,characteristics:(null==r||null==(n=r.characteristics)?void 0:n.map(e=>({...e,name:a===t?e.name:e.nameTranslations[a],value:a===t?e.value:e.valueTranslations[a],nameTranslations:e.nameTranslations,valueTranslations:e.valueTranslations})))||[],creationDate:null==r?void 0:r.creationDate,deliveryMethods:(null==r||null==(i=r.deliveryMethods)?void 0:i.map(e=>({...e,name:a===t?e.name:"".concat(e.name," ").concat(a)})))||[],daysBeforeDiscountExpires:null==r?void 0:r.daysBeforeDiscountExpires,deliveryMethod:(null==r?void 0:r.deliveryMethod)?{...r.deliveryMethod,name:a===t?r.deliveryMethod.name||"":"".concat(r.deliveryMethod.name||""," ").concat(a)}:void 0,deliveryMethodsDetails:(null==r||null==(o=r.deliveryMethodsDetails)?void 0:o.map(e=>({...e,name:a===t?e.name:e.nameTranslations[a],value:a===t?e.value:e.valueTranslations[a],nameTranslations:e.nameTranslations,valueTranslations:e.valueTranslations})))||[],discount:null==r?void 0:r.discount,discountedPrice:null==r?void 0:r.discountedPrice,originalPrice:null==r?void 0:r.originalPrice,mainDescription:a===t?(null==r?void 0:r.mainDescription)||"":(null==r?void 0:r.mainDescriptionTranslations)&&r.mainDescriptionTranslations[a]||"",furtherDescription:a===t?(null==r?void 0:r.furtherDescription)||"":(null==r?void 0:r.furtherDescriptionTranslations)&&r.furtherDescriptionTranslations[a]||"",summaryDescription:a===t?(null==r?void 0:r.summaryDescription)||"":"".concat((null==r?void 0:r.summaryDescription)||""," ").concat(a),primaryDescription:a===t?(null==r?void 0:r.primaryDescription)||"":"".concat((null==r?void 0:r.primaryDescription)||""," ").concat(a),priceUnit:a===t?(null==r?void 0:r.priceUnit)||"":"".concat((null==r?void 0:r.priceUnit)||""," ").concat(a),previewImageUrl:null==r?void 0:r.previewImageUrl}}},{}))(i,a,e)),[s,_]=(0,n.useState)(()=>{var t,r,n,i,l,s;return{isValidForm:!1,submitAttempted:!1,similarProducts:new Set,selectedCategory:(null==e?void 0:e.category)||null,selectedDeliveryMethodIds:[1],saleDate:(null==e||null==(t=e.daysBeforeDiscountExpires)?void 0:t.toString())||"",currentLangState:a,cardTitle:(null==e?void 0:e.title)||"",uploadedFiles:[],remainingInitialImages:(null==e?void 0:e.media.map(e=>e.url))||[],objectRemainingInitialImages:(null==e?void 0:e.media.map((e,t)=>({id:e.id,position:t})))||[],pricesArray:(null==e?void 0:e.prices.map(e=>({currency:e.currency,priceWithDiscount:e.discountedPrice.toString(),priceWithoutDiscount:e.originalPrice.toString(),quantity:"".concat(e.from),value:Math.min(e.discountedPrice,e.originalPrice),unit:e.unit})))||[],descriptionImages:[],descriptionMatrix:(null==e?void 0:e.characteristics.map(e=>[e.name,e.value]))||[],packageArray:[],companyData:{topDescription:(null==e||null==(r=e.aboutVendor)?void 0:r.mainDescription)||"",images:e&&(null==e?void 0:e.aboutVendor)&&(null==e||null==(i=e.aboutVendor)||null==(n=i.media)?void 0:n.length)>0?e.aboutVendor.media.map(e=>({image:e.url,description:e.altText})):[{image:null,description:""},{image:null,description:""},{image:null,description:""},{image:null,description:""}],bottomDescription:(null==e||null==(l=e.aboutVendor)?void 0:l.furtherDescription)||""},companyDataImages:(null==e||null==(s=e.aboutVendor)?void 0:s.media.map((e,t)=>({id:e.id,position:t})))||[],faqMatrix:(null==e?void 0:e.faq.map(e=>[e.question,e.answer]))||[["",""],["",""],["",""],["",""],["",""]],errors:{cardTitle:"",uploadedFiles:"",pricesArray:"",description:"",descriptionImages:"",descriptionMatrix:"",companyData:"",faqMatrix:""},cardObjectForOthers:o}}),[c,d]=(0,n.useState)(()=>((e,t,r)=>e.reduce((e,t)=>{var a;return{...e,[t]:(null==r||null==(a=r.faq)?void 0:a.map(e=>["".concat(e.questionTranslations[t]),"".concat(e.answerTranslations[t]," ")]))||[["",""],["",""],["",""],["",""],["",""]]}},{}))(i,0,e)),[u,p]=(0,n.useState)(()=>((e,t,r)=>null==e?void 0:e.reduce((e,t)=>({...e,[t]:(null==r?void 0:r.characteristics.map(e=>["".concat(e.nameTranslations[t]),"".concat(e.valueTranslations[t])]))||[]}),{}))(i,0,e));return{formState:s,setFormState:_,cardObjectForOthers:o,setCardObjectForOthers:l,faqMatrixForOthers:c,setFaqMatrixForOthers:d,descriptionMatrixForOthers:u,setDescriptionMatrixForOthers:p,typeCardObject:typeof o}})(t),[N,D]=(0,n.useState)(new Set),[E,S]=(0,n.useState)((null==t?void 0:t.category)||null),P=(0,w.c3)("createCard"),A=(0,H.usePathname)(),k=(0,L.f4)(),[F,R]=(0,n.useState)(k),[q,V]=(0,n.useState)((null==t?void 0:t.title)||""),{descriptions:z}=(0,y.N)(e=>e.multilingualDescriptions),{ru:B,en:K,zh:Q}=(0,y.N)(e=>e.multiLanguageCardPriceData),Z=(0,n.useMemo)(()=>({ru:B,en:K,zh:Q}),[B,K,Q]),{setDescriptions:Y,setCharacteristics:X,setDelivery:$,setPackaging:ee,updatePriceInfo:et}=(0,C.d)();(0,n.useEffect)(()=>{(e=>{var t,r,a,n,i,o,l,s,_,c,d,u,p,m,g,h,x,v;let{setDescriptions:w,setCharacteristics:C,setDelivery:y,setPackaging:f,updatePriceInfo:b,initialData:j}=e;w({ru:{description:(null==j||null==(t=j.mainDescriptionTranslations)?void 0:t.ru)||"",additionalDescription:(null==j||null==(r=j.furtherDescriptionTranslations)?void 0:r.ru)||"",furtherDescription:(null==j||null==(a=j.furtherDescriptionTranslations)?void 0:a.ru)||""},en:{description:(null==j||null==(n=j.mainDescriptionTranslations)?void 0:n.en)||"",additionalDescription:(null==j||null==(i=j.furtherDescriptionTranslations)?void 0:i.en)||"",furtherDescription:(null==j||null==(o=j.furtherDescriptionTranslations)?void 0:o.en)||""},zh:{description:(null==j||null==(l=j.mainDescriptionTranslations)?void 0:l.zh)||"",additionalDescription:(null==j||null==(s=j.furtherDescriptionTranslations)?void 0:s.zh)||"",furtherDescription:(null==j||null==(_=j.furtherDescriptionTranslations)?void 0:_.zh)||""}}),C({language:"ru",characteristics:(null==j?void 0:j.characteristics.map(e=>({title:e.nameTranslations.ru,characteristic:e.valueTranslations.ru})))||[]}),C({language:"en",characteristics:(null==j?void 0:j.characteristics.map(e=>({title:e.nameTranslations.en,characteristic:e.valueTranslations.en})))||[]}),C({language:"zh",characteristics:(null==j?void 0:j.characteristics.map(e=>({title:e.nameTranslations.zh,characteristic:e.valueTranslations.zh})))||[]}),y({language:"ru",delivery:(null==j||null==(c=j.deliveryMethodsDetails)?void 0:c.map(e=>({title:e.nameTranslations.ru,daysDelivery:e.valueTranslations.ru})))||[]}),y({language:"en",delivery:(null==j||null==(d=j.deliveryMethodsDetails)?void 0:d.map(e=>({title:e.nameTranslations.en,daysDelivery:e.valueTranslations.en})))||[]}),y({language:"zh",delivery:(null==j||null==(u=j.deliveryMethodsDetails)?void 0:u.map(e=>({title:e.nameTranslations.zh,daysDelivery:e.valueTranslations.zh})))||[]}),f({language:"ru",packaging:(null==j||null==(p=j.packagingOptions)?void 0:p.map(e=>({title:e.nameTranslations.ru||e.name,price:e.price.toString()})))||[]}),f({language:"en",packaging:(null==j||null==(m=j.packagingOptions)?void 0:m.map(e=>({title:e.nameTranslations.en||e.name,price:e.price.toString()})))||[]}),f({language:"zh",packaging:(null==j||null==(g=j.packagingOptions)?void 0:g.map(e=>({title:e.nameTranslations.zh||e.name,price:e.price.toString()})))||[]}),b({language:"ru",field:"daysBeforeSale",value:(null==j?void 0:j.daysBeforeDiscountExpires.toString())||""}),b({language:"ru",field:"minimalVolume",value:(null==j||null==(h=j.minimumOrderQuantity)?void 0:h.toString())||""}),b({language:"en",field:"daysBeforeSale",value:(null==j?void 0:j.daysBeforeDiscountExpires.toString())||""}),b({language:"en",field:"minimalVolume",value:(null==j||null==(x=j.minimumOrderQuantity)?void 0:x.toString())||""}),b({language:"zh",field:"daysBeforeSale",value:(null==j?void 0:j.daysBeforeDiscountExpires.toString())||""}),b({language:"zh",field:"minimalVolume",value:(null==j||null==(v=j.minimumOrderQuantity)?void 0:v.toString())||""})})({setDescriptions:Y,setCharacteristics:X,setDelivery:$,setPackaging:ee,updatePriceInfo:et,initialData:t}),j({ru:(null==t?void 0:t.faq.map(e=>[e.questionTranslations.ru,e.answerTranslations.ru]))||[["",""]]}),j({en:(null==t?void 0:t.faq.map(e=>[e.questionTranslations.en,e.answerTranslations.en]))||[["",""]]}),j({zh:(null==t?void 0:t.faq.map(e=>[e.questionTranslations.zh,e.answerTranslations.zh]))||[["",""]]}),j({[k]:(null==t?void 0:t.faq.map(e=>{var t,r;return[null==(t=e.questionTranslations)?void 0:t[k],null==(r=e.answerTranslations)?void 0:r[k]]}))||[["",""]]}),console.log("current faq matrix",g,null==t?void 0:t.faq)},[t]);let er=(0,n.useCallback)((e,t)=>{let r=null==m?void 0:m[F];return(null==r?void 0:r[t])!==void 0?r[t]:e},[F,k,m]),{modalImage:ea,isModalOpen:en,openModal:ei,closeModal:eo}=x(),el=(0,v.A)(),[es,e_]=(0,n.useState)([]),[ec,ed]=(0,n.useState)((null==t?void 0:t.media.map(e=>e.url))||[]),eu=(0,n.useMemo)(()=>(null==t?void 0:t.media.map((e,t)=>({id:e.id,position:t})))||[],[null==t?void 0:t.media]),[ep,em]=(0,n.useState)(eu||[]),[eg,eh]=(0,n.useState)([["",""]]),[ex,ev]=(0,n.useState)((null==t?void 0:t.prices.map(e=>({currency:e.currency,priceWithDiscount:e.discountedPrice.toString(),priceWithoutDiscount:e.originalPrice.toString(),quantity:"".concat(e.from).concat(e.to?"-".concat(e.to):""),value:Math.min(e.discountedPrice,e.originalPrice),unit:e.unit})))||[]),[ew,eC]=(0,n.useState)([]),{characteristics:ey}=(0,y.N)(e=>e.multiLanguageCardPriceData[k||k]);console.log("characteristics after selector",ey);let[ef,eb]=(0,n.useState)({cardTitle:"",uploadedFiles:"",pricesArray:"",description:"",descriptionImages:"",descriptionMatrix:""}),{validateAllFields:ej}=((e,t,r)=>{let a=(0,n.useRef)({cardTitle:"",uploadedFiles:"",pricesArray:"",description:"",descriptionImages:"",descriptionMatrix:""}),i=(0,n.useRef)({currentTitle:"",uploadedFilesLength:0,remainingImagesLength:0,pricesArrayLength:0,currentMainDescription:"",descriptionMatrixString:""}),o=t()||"",l=(0,n.useMemo)(()=>{var t;let r=null==(t=e.cardObjectForOthers)?void 0:t[e.currentLangState];return(null==r?void 0:r.title)||e.cardTitle||""},[e.cardObjectForOthers,e.currentLangState,e.cardTitle]),s=JSON.stringify(e.descriptionMatrix),_=(0,n.useCallback)(t=>{let r=i.current;switch(t){case"cardTitle":return r.currentTitle!==l;case"pricesArray":var a;return r.pricesArrayLength!==((null==(a=e.pricesArray)?void 0:a.length)||0);case"description":return r.currentMainDescription!==o;case"descriptionMatrix":return r.descriptionMatrixString!==s;default:return!1}},[l,e.uploadedFiles,e.remainingInitialImages,e.pricesArray,o,s]),c=(0,n.useCallback)(()=>{var t,r,a;i.current={currentTitle:l,uploadedFilesLength:(null==(t=e.uploadedFiles)?void 0:t.length)||0,remainingImagesLength:(null==(r=e.remainingInitialImages)?void 0:r.length)||0,pricesArrayLength:(null==(a=e.pricesArray)?void 0:a.length)||0,currentMainDescription:o,descriptionMatrixString:s}},[l,e.uploadedFiles,e.remainingInitialImages,e.pricesArray,o,s]),d=(0,n.useCallback)(function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n&&!_(t))return a.current[t]||"";let i=((e,t,r,a,n,i,o,l)=>{switch(e){case"cardTitle":return t&&0!==t.trim().length?"":l("titleError");case"uploadedFiles":let s=((null==r?void 0:r.length)||0)+((null==a?void 0:a.length)||0);return s<1?l("minimumImages")+", ".concat(l("now")," ").concat(s,"/1"):"";case"pricesArray":return n&&0!==n.length?"":l("onePriceError");case"description":return i&&0!==i.trim().length?"":l("descriptionError");case"descriptionMatrix":return 0===o.filter(e=>e.some(e=>e.trim())).length?l("characteristicError"):"";default:return""}})(t,l,e.uploadedFiles,e.remainingInitialImages,e.pricesArray,o,e.descriptionMatrix,r);return a.current[t]=i,i},[_,l,e.uploadedFiles,e.remainingInitialImages,e.pricesArray,o,e.descriptionMatrix,r]),u=(0,n.useCallback)(()=>{c();let e={cardTitle:d("cardTitle",!0),uploadedFiles:d("uploadedFiles",!0),pricesArray:d("pricesArray",!0),description:d("description",!0),descriptionMatrix:d("descriptionMatrix",!0),descriptionImages:""},t=!Object.values(e).some(e=>""!==e);return{validationErrors:e,isFormValid:t}},[d,c]),p=(0,n.useCallback)(()=>({...a.current}),[]),m=(0,n.useCallback)(()=>!Object.values(a.current).some(e=>""!==e),[]);return c(),{validateAllFields:u,validateSingleField:e=>d(e,!1),getCurrentValidationErrors:p,isCurrentFormValid:m,validationErrors:a.current,isFormValid:m()}})((0,n.useMemo)(()=>{var e,t,a,n;return{isValidForm:r,submitAttempted:!0,similarProducts:N,selectedCategory:E,saleDate:null==Z||null==(t=Z[F])||null==(e=t.priceInfo)?void 0:e.daysBeforeSale,currentLangState:F,cardTitle:q,uploadedFiles:es,cardObjectForOthers:m,remainingInitialImages:ec,objectRemainingInitialImages:ep,pricesArray:ex,descriptionImages:ew,descriptionMatrix:null==ey?void 0:ey.map(e=>[e.title,e.characteristic]),packageArray:null==Z||null==(n=Z[F])||null==(a=n.packaging)?void 0:a.map(e=>[e.title,e.price]),faqMatrix:(null==g?void 0:g[F||"en"])||[],errors:ef,selectedDeliveryMethodIds:[1]}},[r,N,E,Z,F,q,es,m,ec,ep,ex,ew,ey,g,ef]),()=>{var e;return null==z||null==(e=z[F])?void 0:e.description},P),eN=(0,n.useCallback)(e=>{setTimeout(()=>{e_(e),ef.uploadedFiles&&e.length+ec.length>=1&&eb(e=>({...e,uploadedFiles:""}))},0)},[ef.uploadedFiles,ec.length]),eD=(0,n.useCallback)(e=>{ed(e)},[]),eE=(0,n.useCallback)(e=>{ev(e),ef.pricesArray&&eb(e=>({...e,pricesArray:""}))},[ef.pricesArray]);(0,n.useEffect)(()=>{var e;let t=null==m||null==(e=m[F])?void 0:e.title;void 0!==t&&t!==q&&V(t)},[m,q,F]);let eI=(0,n.useCallback)(e=>{V(e);let t={...m};t[F]={...null==t?void 0:t[F],title:e},f(t),ef.cardTitle&&e.trim().length>0&&eb(e=>({...e,cardTitle:""}))},[m,F,ef.cardTitle]),eS=(0,n.useCallback)(async e=>{e.preventDefault();let{validationErrors:r,isFormValid:n}=ej();if(eb(r),i(n),!n)return void Object.entries(r).forEach(e=>{let[t,r]=e;r&&W.o.error((0,a.jsxs)("div",{"data-special-attr-for-error":!0,style:{lineHeight:1.5},children:[(0,a.jsx)("strong",{style:{display:"block",marginBottom:4},children:P("error")}),(0,a.jsx)("span",{children:r})]}),{style:{background:"#AC2525"}})});let o=W.o.loading("Saving...");try{await U({cardObjectForOthers:m,faqMatrixForOthers:g,similarProducts:N,selectedCategory:E,langFromPathname:k,currentLangState:F,cardTitle:q,descriptions:z,multyLangObjectForPrices:Z,uploadedFiles:es,remainingInitialImages:ec,objectRemainingInitialImages:ep,pricesArray:ex,pathname:A,initialData:t}),W.o.dismiss(o),W.o.success((0,a.jsxs)("div",{style:{lineHeight:1.5,marginLeft:"10px"},children:[(0,a.jsx)("strong",{style:{display:"block",marginBottom:4,fontSize:"18px"},children:P("gratulation")}),(0,a.jsx)("span",{children:P("cardSuccess").split(" ")[0]+((null==t?void 0:t.id)?P("successUpdateCardEndText"):P("successCreateCardEndText"))})]}),{style:{background:"#2E7D32"}}),p.push("/vendor")}catch(e){var l,s;W.o.dismiss(o),console.log(e,"path:",null==e||null==(s=e.message)||null==(l=s.errors)?void 0:l.message)}},[ej,m,g,N,E,k,F,q,z,Z,es,ec,ep,ex,A,t,P]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{isOpen:en,onClose:eo,children:ea&&(0,a.jsx)(d.default,{className:"".concat(o().drop__extra__image," ").concat(o().drop__extra__image__modal),src:ea,alt:"Help image",width:1e3,height:1e3})}),(0,a.jsx)(l.default,{}),(0,a.jsx)("div",{className:"container",children:(0,a.jsxs)("div",{className:"".concat(o().create__inner),children:[(0,a.jsx)("h1",{className:"".concat(o().create__title),children:P("createCardTitle")}),(0,a.jsxs)("div",{className:"".concat(o().language__switcher),children:[(0,a.jsx)("p",{className:"".concat(o().language__switcher__title),children:P("languageForInput")}),(0,a.jsxs)("p",{className:"".concat(o().language__switcher__subtitle),children:[P("languageForInputSubtitle")," - ",k]}),(0,a.jsxs)("div",{className:"".concat(o().language__buttons),children:[(0,a.jsx)("button",{id:"cy-language-button--switch-ru","data-active":"ru"===F,type:"button",className:"".concat(o().language__button," ").concat("ru"===F?o().language__button__active:""),onClick:()=>R("ru"),children:"RU"}),(0,a.jsx)("button",{id:"cy-language-button--switch-en","data-active":"en"===F,type:"button",className:"".concat(o().language__button," ").concat("en"===F?o().language__button__active:""),onClick:()=>R("en"),children:"EN"}),(0,a.jsx)("button",{id:"cy-language-button--switch-zh","data-active":"zh"===F,type:"button",className:"".concat(o().language__button," ").concat("zh"===F?o().language__button__active:""),onClick:()=>R("zh"),children:"ZH"})]})]}),(0,a.jsxs)("form",{onSubmit:eS,className:"".concat(o().create__form),children:[(0,a.jsxs)("span",{className:"".concat(o().create__input__box__span),children:[(0,a.jsxs)("div",{className:"".concat(o().label__title__box),children:[(0,a.jsx)("label",{className:"".concat(o().create__label__title),htmlFor:"cy-title-create-input",children:P("name")}),(0,a.jsx)(c.A,{direction:el&&el<768?"bottom":"right",safeAreaEnabled:!0,positionIsAbsolute:!1,trigger:"hover",extraClass:"".concat(o().drop__extra," ").concat(o().drop__extra__first),arrowClassName:"".concat(o().arrow__none),title:(0,a.jsx)(d.default,{src:G,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{className:"".concat(o().drop__extra__image),src:J.title,alt:P("altHelpWithName"),width:300,height:300,onClick:()=>ei(J.title)},1)]})]}),(0,a.jsx)(_.A,{errorValue:ef.cardTitle,extraClass:"".concat(o().create__input__title),idForLabel:"cy-title-create-input",placeholder:P("name"),currentValue:er(q,"title"),onSetValue:eI,theme:"superWhite"})]}),(0,a.jsxs)("div",{className:"".concat(o().create__input__box__span__category),children:[(0,a.jsx)("div",{className:"".concat(o().label__title__box),children:(0,a.jsx)("p",{className:"".concat(o().create__label__title),children:P("categoryTitle")})}),(0,a.jsx)(O,{initialProductCategory:E||void 0,onSetCategory:e=>S(e)})]}),(0,a.jsxs)("div",{className:"".concat(o().create__input__box__span," ").concat(o().create__input__box__span__images),children:[(0,a.jsxs)("div",{className:"".concat(o().label__title__box),children:[(0,a.jsx)("p",{className:"".concat(o().create__label__title),children:P("imageCard")}),(0,a.jsx)(c.A,{direction:el&&el<768?"bottom":"right",safeAreaEnabled:!0,positionIsAbsolute:!1,trigger:"hover",extraClass:"".concat(o().drop__extra," ").concat(o().drop__extra__second),arrowClassName:"".concat(o().arrow__none),title:(0,a.jsx)(d.default,{src:G,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{className:"".concat(o().drop__extra__image),src:J.productImages,alt:P("altHelpWithImageCard"),width:300,height:300,onClick:()=>ei(J.productImages)},1)]})]}),(0,a.jsx)(u.A,{onFilesChange:eN,onActiveImagesChange:eD,activeImages:ec,maxFiles:9,minFiles:1,allowMultipleFiles:!0,errorValue:ef.uploadedFiles,setErrorValue:e=>eb(t=>({...t,uploadedFiles:e})),inputIdPrefix:"product-images"})]}),(0,a.jsxs)("div",{className:"".concat(o().label__title__box),children:[(0,a.jsx)("h3",{className:"".concat(o().create__similar__products__box__title),children:P("similarProducts")}),(0,a.jsx)(c.A,{direction:el&&el<768?"bottom":"right",safeAreaEnabled:!0,positionIsAbsolute:!1,trigger:"hover",extraClass:"".concat(o().drop__extra," ").concat(o().drop__extra__second),arrowClassName:"".concat(o().arrow__none),title:(0,a.jsx)(d.default,{src:G,alt:"vopros",width:27,height:27}),items:[(0,a.jsx)(d.default,{className:"".concat(o().drop__extra__image),src:J.similarProducts,alt:P("altHelpWithSimilarProducts"),width:300,height:300,onClick:()=>ei(J.similarProducts)},1)]})]}),(0,a.jsx)(M,{onUpdateProductsSet:D}),(0,a.jsx)(b,{inputType:["text","number","number","dropdown","dropdown"],pricesArray:ex.map(e=>[e.quantity,e.priceWithoutDiscount,e.priceWithDiscount,e.currency,e.unit]),dropdownPricesOptions:[["RUB","USD","CNY"],[P("mg"),P("g"),P("kg"),P("c"),P("t"),P("ml"),P("l"),P("hl"),P("m3"),P("m2"),P("cm2"),P("pcs"),P("pack"),P("m"),P("cm"),P("pair"),P("set"),P("box")]],canCreateNewOption:[!1,!0],currentLanguage:F,onSetPricesArray:eE,pricesError:ef.pricesArray}),(0,a.jsx)(I,{descriptionError:ef.description,currentDynamicLang:F}),"ru"===F&&(0,a.jsx)(T,{values:null==g?void 0:g.ru,onChange:e=>{console.log("faqMatrixForOthers ru",null==g?void 0:g.ru),console.log("ru matrix update",e);let t={...g};t.ru=e,j(t)}}),"en"===F&&(0,a.jsx)(T,{values:null==g?void 0:g.en,onChange:e=>{console.log("faqMatrixForOthers en",null==g?void 0:g.en),console.log("en matrix update",e);let t={...g};t.en=e,j(t)}}),"zh"===F&&(0,a.jsx)(T,{values:null==g?void 0:g.zh,onChange:e=>{console.log("faqMatrixForOthers zh",null==g?void 0:g.zh),console.log("zh matrix update",e);let t={...g};t.zh=e,j(t)}}),(0,a.jsx)("div",{className:"".concat(o().button__box),children:(0,a.jsx)("button",{id:"cy-submit-create-button",style:{opacity:r?1:.7,cursor:r?"pointer":"not-allowed"},className:"".concat(o().create____submit__button),type:"submit",onClick:()=>{ej(),Object.entries(ef).forEach(e=>{let[t,r]=e;r&&W.o.error((0,a.jsxs)("div",{"data-special-attr-for-error":!0,style:{lineHeight:1.5},children:[(0,a.jsx)("strong",{style:{display:"block",marginBottom:4},children:P("error")}),(0,a.jsx)("span",{children:r})]}),{style:{background:"#AC2525"}})})},children:P("save")})})]})]})}),(0,a.jsx)(s.default,{})]})}},7915:e=>{e.exports={drop__extra:"CreateFaqCard_drop__extra__syUvm",descr__el__title__right:"CreateFaqCard_descr__el__title__right__xKEHN",descr__title:"CreateFaqCard_descr__title__lHIva",create:"CreateFaqCard_create__UdGsB"}},14979:e=>{e.exports={drop__extra__modal__catalog:"CreateSimilarProducts_drop__extra__modal__catalog__g1Hm3",create__similar__products__box:"CreateSimilarProducts_create__similar__products__box__1h31P",list__items:"CreateSimilarProducts_list__items__XDkeT",cardsCatalog__create:"CreateSimilarProducts_cardsCatalog__create__qjslp",cardsCatalog__create__image:"CreateSimilarProducts_cardsCatalog__create__image__uvtoF",cardsCatalog__create__text:"CreateSimilarProducts_cardsCatalog__create__text__ZEg1D",cardsCatalog__create__button:"CreateSimilarProducts_cardsCatalog__create__button__u_PpZ"}},16385:e=>{e.exports={second__drop__extra:"CreateDescriptionsElements_second__drop__extra__PpIcB",editor__extra__text:"CreateDescriptionsElements_editor__extra__text__b8OgY",editor__wrapper:"CreateDescriptionsElements_editor__wrapper__6o60p","md-editor-preview":"CreateDescriptionsElements_md-editor-preview__mD_B9","md-editor-input-wrapper":"CreateDescriptionsElements_md-editor-input-wrapper__9YR37","cm-string":"CreateDescriptionsElements_cm-string__qSAyG","cm-url":"CreateDescriptionsElements_cm-url__eSAFc","cm-line":"CreateDescriptionsElements_cm-line__4ugCu","cm-editor":"CreateDescriptionsElements_cm-editor__UP0_y",right:"CreateDescriptionsElements_right__seTLH",descr__el__title__right:"CreateDescriptionsElements_descr__el__title__right__gI8Bx",truncated__base64:"CreateDescriptionsElements_truncated__base64__5ACuh",descr__el__title:"CreateDescriptionsElements_descr__el__title___9UhN",descr__title:"CreateDescriptionsElements_descr__title__uLjLa",left:"CreateDescriptionsElements_left__Leg9b",left__top__descr:"CreateDescriptionsElements_left__top__descr__9PrJw",left__bottom__descr:"CreateDescriptionsElements_left__bottom__descr__H3Rm5",create__descriptions__box:"CreateDescriptionsElements_create__descriptions__box__0GeHf",drop__extra:"CreateDescriptionsElements_drop__extra__oy1yg",has__error:"CreateDescriptionsElements_has__error__Ec2RH",error__message:"CreateDescriptionsElements_error__message__H_3wP",required:"CreateDescriptionsElements_required__xU6Qr",required__error:"CreateDescriptionsElements_required__error__nHvz6",optional:"CreateDescriptionsElements_optional__wUf45"}},19250:e=>{e.exports={create__inner:"CreateCard_create__inner__OxNyX",create__title:"CreateCard_create__title__YJ5RE",create__label__title:"CreateCard_create__label__title__4gZ_P",arrow__none:"CreateCard_arrow__none__kodBK",label__title__box:"CreateCard_label__title__box__RpgkQ",create__input__title:"CreateCard_create__input__title__W1Agq",create__input__box__span__category:"CreateCard_create__input__box__span__category__TIYsy",create__similar__products__box__title:"CreateCard_create__similar__products__box__title__ZGbBF",create__input__box__span:"CreateCard_create__input__box__span__EAWLz",create__input__box__span__images:"CreateCard_create__input__box__span__images__fbO_n",create____submit__button:"CreateCard_create____submit__button__Q3ayQ",button__box:"CreateCard_button__box__47ybR",drop__extra__image:"CreateCard_drop__extra__image__H3iNh",drop__extra__image__modal:"CreateCard_drop__extra__image__modal__E_pnO",drop__extra:"CreateCard_drop__extra__KmHPw",drop__extra__first:"CreateCard_drop__extra__first__3HtMF",drop__extra__second:"CreateCard_drop__extra__second__yRdXL",language__switcher:"CreateCard_language__switcher__NP9oA",language__switcher__title:"CreateCard_language__switcher__title__Y7uKE",language__buttons:"CreateCard_language__buttons__hcbWh",language__button:"CreateCard_language__button__88MTB",language__button__active:"CreateCard_language__button__active__DgKnP",translation__indicators:"CreateCard_translation__indicators__tYqVp",translation__indicator:"CreateCard_translation__indicator__2pgDx",translation__indicator__filled:"CreateCard_translation__indicator__filled__BMTdx"}},20447:e=>{e.exports={cat__box:"CreateCardProductCategory_cat__box__bEMM_",cat__loading:"CreateCardProductCategory_cat__loading__QDULq",cat__error:"CreateCardProductCategory_cat__error__SHm4L",cat__selected:"CreateCardProductCategory_cat__selected__udJ20",cat__empty:"CreateCardProductCategory_cat__empty__XKmcF",cat__selectedItem:"CreateCardProductCategory_cat__selectedItem__FH9cP",cat__image:"CreateCardProductCategory_cat__image__pdxI9",cat__name:"CreateCardProductCategory_cat__name__DLGug",cat__remove:"CreateCardProductCategory_cat__remove___P2G4",cat__add:"CreateCardProductCategory_cat__add__J0HFp",cat__searchWrapper:"CreateCardProductCategory_cat__searchWrapper__9Ibxe",cat__search:"CreateCardProductCategory_cat__search__JVGRw",cat__backdrop:"CreateCardProductCategory_cat__backdrop__9DtE5",cat__dropdown:"CreateCardProductCategory_cat__dropdown__4zcpF",cat__noResults:"CreateCardProductCategory_cat__noResults__18DTj",cat__notFound:"CreateCardProductCategory_cat__notFound__sGl5l",cat__notFoundContent:"CreateCardProductCategory_cat__notFoundContent__AUHor",cat__notFoundIcon:"CreateCardProductCategory_cat__notFoundIcon__hNAjr",cat__notFoundText:"CreateCardProductCategory_cat__notFoundText__FTOU6",cat__notFoundSubtext:"CreateCardProductCategory_cat__notFoundSubtext__6Epb_",cat__dropdownList:"CreateCardProductCategory_cat__dropdownList__W6ez_",cat__categoryGroup:"CreateCardProductCategory_cat__categoryGroup___EXcZ",cat__dropdownItem:"CreateCardProductCategory_cat__dropdownItem__kkpvt","cat__dropdownItem--selected":"CreateCardProductCategory_cat__dropdownItem--selected__qjw9P","cat__dropdownItem--level0":"CreateCardProductCategory_cat__dropdownItem--level0__nCIxw","cat__dropdownItem--level1":"CreateCardProductCategory_cat__dropdownItem--level1__kRhwm","cat__dropdownItem--level2":"CreateCardProductCategory_cat__dropdownItem--level2__WqhpB","cat__dropdownItem--level3":"CreateCardProductCategory_cat__dropdownItem--level3__1n01U",cat__expandIcon:"CreateCardProductCategory_cat__expandIcon__H5OTe","cat__expandIcon--expanded":"CreateCardProductCategory_cat__expandIcon--expanded__Sy1EL",cat__levelIndicator:"CreateCardProductCategory_cat__levelIndicator__sQnr0",cat__dropdownImage:"CreateCardProductCategory_cat__dropdownImage__oJCnm",cat__dropdownName:"CreateCardProductCategory_cat__dropdownName__4qq3G",cat__checkmark:"CreateCardProductCategory_cat__checkmark__KdIvY",cat__childrenContainer:"CreateCardProductCategory_cat__childrenContainer__2w_U7",slideDown:"CreateCardProductCategory_slideDown__iV4r6"}},30383:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(12115);let n=a.createContext({});function i(e){var t,r,i;let{count:o=1,wrapper:l,className:s,containerClassName:_,containerTestId:c,circle:d=!1,style:u,...p}=e,m=a.useContext(n),g={...p};for(let[e,t]of Object.entries(p))void 0===t&&delete g[e];let h={...m,...g,circle:d},x={...u,...function(e){let{baseColor:t,highlightColor:r,width:a,height:n,borderRadius:i,circle:o,direction:l,duration:s,enableAnimation:_=!0,customHighlightBackground:c}=e,d={};return"rtl"===l&&(d["--animation-direction"]="reverse"),"number"==typeof s&&(d["--animation-duration"]="".concat(s,"s")),_||(d["--pseudo-element-display"]="none"),("string"==typeof a||"number"==typeof a)&&(d.width=a),("string"==typeof n||"number"==typeof n)&&(d.height=n),("string"==typeof i||"number"==typeof i)&&(d.borderRadius=i),o&&(d.borderRadius="50%"),void 0!==t&&(d["--base-color"]=t),void 0!==r&&(d["--highlight-color"]=r),"string"==typeof c&&(d["--custom-highlight-background"]=c),d}(h)},v="react-loading-skeleton";s&&(v+=" ".concat(s));let w=null!=(t=h.inline)&&t,C=[],y=Math.ceil(o);for(let e=0;e<y;e++){let t=x;if(y>o&&e===y-1){let e=null!=(r=t.width)?r:"100%",a=o%1,n="number"==typeof e?e*a:"calc(".concat(e," * ").concat(a,")");t={...t,width:n}}let n=a.createElement("span",{className:v,style:t,key:e},"‌");w?C.push(n):C.push(a.createElement(a.Fragment,{key:e},n,a.createElement("br",null)))}return a.createElement("span",{className:_,"data-testid":c,"aria-live":"polite","aria-busy":null==(i=h.enableAnimation)||i},l?C.map((e,t)=>a.createElement(l,{key:t},e)):C)}},34229:(e,t,r)=>{Promise.resolve().then(r.bind(r,2183))},37220:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(95155),n=r(12115),i=r(47650),o=r(37696),l=r.n(o);let s=e=>{let{children:t,isOpen:r,onClose:o,extraClass:s}=e;return((0,n.useEffect)(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[r]),r)?(0,i.createPortal)((0,a.jsx)("div",{className:"".concat(l().modal__window__default__back," ").concat(s),onClick:e=>{e.stopPropagation(),e.preventDefault(),console.log("onBackClick"),o(e)},children:(0,a.jsxs)("div",{className:"".concat(l().modal__inner),onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("div",{className:"".concat(l().modal__header),children:(0,a.jsx)("button",{id:"cy-modal-window-default-close-button",className:"".concat(l().modal__header__close__button),onClick:e=>o(e),children:(0,a.jsx)("svg",{className:"".concat(l().modal__header__close__button__svg),width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M19.001 5.49988L5.00098 19.4999M5.00098 5.49988L19.001 19.4999",stroke:"#141416",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})}),t]})}),document.getElementById("modal_portal")):null}},37696:e=>{e.exports={modal__window__default__back:"ModalWindowDefault_modal__window__default__back__x2qQl",modal__inner:"ModalWindowDefault_modal__inner__lgloM",modal__header:"ModalWindowDefault_modal__header__3k5nZ"}},42815:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var a=r(95155),n=r(12115),i=r(66766),o=r(75143),l=r(50402),s=r(78266),_=r(40055),c=r(83429),d=r.n(c),u=r(98935),p=r(60584);let m=e=>{var t,r;let{value:i,options:o,placeholder:l,onSelect:s,hasError:c,inputId:u,canCreateNew:m=!1,readOnly:g=!1}=e,[h,x]=(0,n.useState)(!1),[v,w]=(0,n.useState)(""),[C,y]=(0,n.useState)(!1),f=(0,n.useRef)(null),b=(0,n.useRef)(null),j=(0,p.Tb)(),N={ru:"Создать",en:"Create",zh:"创建"};(0,n.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&(x(!1),y(!1),w(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,n.useEffect)(()=>{let e=e=>{var t;let r=e.target;!(f.current&&(f.current===r||f.current.contains(r)))&&(r!==document.documentElement&&r!==document.body&&r!==window&&(null==(t=f.current)?void 0:t.contains(r))||(x(!1),y(!1),w("")))};if(h)return document.addEventListener("scroll",e,!0),window.addEventListener("scroll",e),()=>{document.removeEventListener("scroll",e,!0),window.removeEventListener("scroll",e)}},[h]),(0,n.useEffect)(()=>{C&&b.current&&b.current.focus()},[C]);let D=()=>{!g&&v.trim()&&(s(v.trim()),x(!1),y(!1),w(""))};return(0,a.jsxs)("div",{className:d().dropdown,ref:f,children:[(0,a.jsx)("div",{className:"".concat(d().dropdown__trigger," ").concat(c?d().error__dropdown:""," ").concat(g?d().dropdown__readonly:""),onClick:()=>!g&&x(!h),id:u,style:{cursor:g?"default":"pointer"},children:(0,a.jsx)("span",{style:{margin:"0 auto"},className:i?d().dropdown__value:d().dropdown__placeholder,children:i||(null==(r=l||"")||null==(t=r.trim())?void 0:t.split(" ")[0])})}),h&&!g&&(0,a.jsxs)("div",{className:d().dropdown__list,children:[m&&(0,a.jsxs)(a.Fragment,{children:[C?(0,a.jsxs)("div",{className:d().dropdown__custom__input__wrapper,children:[(0,a.jsx)(_.A,{refProps:b,theme:"superWhite",onKeyDown:e=>{g||("Enter"===e.key?(e.preventDefault(),D()):"Escape"===e.key&&(y(!1),w("")))},placeholder:"Enter value...",currentValue:v,onSetValue:e=>w(e)}),(0,a.jsxs)("div",{style:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between",marginTop:"5px"},className:d().dropdown__custom__buttons,children:[(0,a.jsx)("button",{style:{margin:"0 auto"},type:"button",onClick:D,className:d().dropdown__custom__button__confirm,disabled:!v.trim(),children:"✓"}),(0,a.jsx)("button",{style:{margin:"0 auto"},type:"button",onClick:()=>{y(!1),w("")},className:d().dropdown__custom__button__cancel,children:"✕"})]})]}):(0,a.jsxs)("div",{className:"".concat(d().dropdown__option," ").concat(d().dropdown__option__create),onClick:()=>{g||y(!0)},children:["+ ",(null==N?void 0:N[j])||"en"]}),o.length>0&&(0,a.jsx)("div",{className:d().dropdown__separator})]}),o.map((e,t)=>(0,a.jsx)("div",{className:"".concat(d().dropdown__option," ").concat(e===i?d().dropdown__option__selected:""),onClick:()=>{!g&&(s(e),x(!1),y(!1),w(""))},children:e},t+u))]})]},u)},g=e=>{var t,r,n,o;let{id:c,rowIndex:p,row:g,titles:h,inputsInRowCount:x,extraClass:v,isLastRow:w,canRemove:C,idNames:y,onUpdateValue:f,onRemoveRow:b,extraButtonMinusClass:j,hasError:N,inputType:D,dropdownOptions:E,canCreateNewOption:I,inputsTheme:S,textAreaProps:P,buttonSizes:T,showDnDButton:A,isOnlyShow:k=!1,onBlur:F,onClick:R,onFocus:M,onKeyUp:q}=e,{attributes:V,listeners:z,setNodeRef:L,transform:O,transition:B,isDragging:W}=(0,l.gl)({id:c}),U={transform:s.Ks.Transform.toString(O),transition:B,opacity:W?.5:1};return(0,a.jsxs)("div",{id:"cy-row-".concat(null==y?void 0:y[0],"-").concat(p),ref:L,style:U,children:[(0,a.jsxs)("div",{className:"".concat(d().rows__inputs__box," ").concat(v||""," ").concat(W?d().dragging:""," ").concat(N?d().error:""," ").concat(!A||k?d().no__drag:""),children:[A&&!k&&(0,a.jsx)("button",{className:d().rows__inputs__drag,...V,...z,type:"button","aria-label":"Перетащить строку",children:(0,a.jsx)(i.default,{src:"/create-card/drag-handle.svg",alt:"drag",width:(null==(t=T.drag)?void 0:t.width)||12,height:(null==(r=T.drag)?void 0:r.height)||18})}),(0,a.jsx)("div",{className:d().rows__inputs__row,style:{gridTemplateColumns:"repeat(".concat(x,", 1fr)")},children:g.map((e,t)=>((e,t)=>{let r=(null==D?void 0:D[t])||"text",n="cy-create-card-row-input-".concat(null==y?void 0:y[t])||0;if("dropdown"===r){let r=(null==E?void 0:E[t])||[],i=(null==I?void 0:I[t])||!1;return(0,a.jsx)(m,{value:e,options:r,placeholder:h[t]||"Выберите значение",onSelect:e=>!k&&f(p,t,e),hasError:N&&!e,inputId:n,canCreateNew:i,readOnly:k},t+n)}if("textarea"===r){var i,o,l;return(0,a.jsx)(u.A,{extraClass:d().area__extra__min__height,theme:S||"lightBlue",placeholder:h[t]||"value...",currentValue:e,onSetValue:e=>!k&&f(p,t,e),errorValue:N&&!e?" ":"",autoResize:null==(i=null==P?void 0:P.autoResize)||i,minRows:null!=(o=null==P?void 0:P.minRows)?o:2,maxRows:null!=(l=null==P?void 0:P.maxRows)?l:5,readOnly:k,onBlur:F&&!k?()=>F(p,t,e):void 0,onClick:R&&!k?()=>R(p,t,e):void 0,onFocus:M&&!k?()=>M(p,t,e):void 0,onKeyUp:q&&!k?r=>q(p,t,e,r):void 0},t)}return(0,a.jsx)(_.A,{inputType:r,idForLabel:n,theme:S||"lightBlue",placeholder:h[t]||"value...",currentValue:e,onSetValue:e=>!k&&f(p,t,e),errorValue:N&&!e?" ":"",readOnly:k,onBlur:F&&!k?()=>F(p,t,e):void 0,onClick:R&&!k?()=>R(p,t,e):void 0,onFocus:M&&!k?()=>M(p,t,e):void 0,onKeyUp:q&&!k?r=>q(p,t,e,r):void 0},t)})(e,t))}),!k&&(0,a.jsx)("button",{className:"".concat(d().rows__inputs__remove," ").concat(j),onClick:()=>b(p),id:"cy-create-card-row-remove-".concat(p),type:"button","aria-label":"Удалить строку",disabled:!C,style:{opacity:C?1:.3},children:(0,a.jsx)(i.default,{src:"/create-card/minusCircle.svg",alt:"minus",width:(null==(n=T.minus)?void 0:n.width)||39,height:(null==(o=T.minus)?void 0:o.height)||39})})]}),!w&&(0,a.jsx)("div",{className:d().gray__bottom__line})]})},h=e=>{var t,r;let{titles:s,initialRowsCount:_=1,inputsInRowCount:c=2,maxRows:u=10,rowsInitialValues:p,onSetValue:m,onRowsChange:h,extraButtonPlusClass:x,extraButtonMinusClass:v,extraClasses:w=[],errorMessage:C="",minFilledRows:y=0,inputType:f,controlled:b=!1,externalValues:j,idNames:N,dropdownOptions:D,canCreateNewOption:E,inputsTheme:I,textAreaProps:S={minRows:2,maxRows:5,autoResize:!0},buttonsSizes:P="large",customButtonSizes:T,showDnDButton:A=!0,isOnlyShow:k=!1,onBlur:F,onClick:R,onFocus:M,onKeyUp:q}=e,[V,z]=(0,n.useState)(()=>{if(b&&j&&j.length>0)return j;if(p&&p.length>0)return p;let e=[];for(let t=0;t<_;t++)e.push(Array(c).fill(""));return e}),[L,O]=(0,n.useState)(()=>(b&&j?j:p&&p.length>0?p:Array(_).fill(0).map(()=>Array(c).fill(""))).map((e,t)=>"row-".concat(t,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)))),B=T||(e=>{switch(e){case"small":return{plus:{width:28,height:28},minus:{width:28,height:28},drag:{width:8,height:12}};case"medium":return{plus:{width:34,height:34},minus:{width:34,height:34},drag:{width:10,height:15}};default:return{plus:{width:39,height:39},minus:{width:39,height:39},drag:{width:12,height:18}}}})(P);(0,n.useEffect)(()=>{b&&j&&JSON.stringify(V)!==JSON.stringify(j)&&(console.log("\uD83D\uDD04 Синхронизация RowsInputs:",{external:j,current:V,rowIdsLength:L.length}),z(j),j.length!==L.length&&O(j.map((e,t)=>t<L.length?L[t]:"row-".concat(t,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)))))},[b,j]),(0,n.useEffect)(()=>{let e=L.filter((e,t)=>L.indexOf(e)!==t);e.length>0&&console.warn("\uD83D\uDEA8 Дублирующиеся rowIds найдены:",e),console.log("\uD83D\uDCCA RowsInputs Debug:",{controlled:b,externalValuesLength:(null==j?void 0:j.length)||0,rowsLength:V.length,rowIdsLength:L.length,currentRowsLength:W.length,duplicatesFound:e.length>0,rowIds:L.slice(0,3)})},[b,j,V,L]);let W=b&&j?j:V,U=e=>e.every(e=>""!==e.trim()),H=(()=>{if(!C||0===y||k)return[];let e=W.filter(U).length,t=[];return W.forEach((e,r)=>{(e=>{let t=e.filter(e=>""!==e.trim()).length;return t>0&&t<e.length})(e)&&t.push(r)}),e<y&&W.forEach((e,r)=>{!(r<y)||U(e)||t.includes(r)||t.push(r)}),t})(),G=(0,o.FR)((0,o.MS)(o.AN,{activationConstraint:{distance:8}}),(0,o.MS)(o.uN,{coordinateGetter:l.JR})),J=e=>{if(k||1===W.length)return;let t=W.filter((t,r)=>r!==e);if(!b){let r=L.filter((t,r)=>r!==e);z(t),O(r)}h&&h(t)},K=(e,t,r)=>{if(k)return;let a=[...W];if(!a[e])return void console.warn("❌ Попытка обновить несуществующую строку:",e,"в массиве длиной:",a.length);a[e][t]=r,b||z(a),m(e,t,r),h&&!b&&h(a)};return W.length!==L.length&&console.warn("⚠️ Несоответствие длины массивов:",{rowsLength:W.length,rowIdsLength:L.length,controlled:b}),(0,a.jsxs)("div",{className:"".concat(d().rows__inputs__wrapper," ").concat(C&&!k?d().has__error:""),children:[(0,a.jsxs)("div",{className:d().rows__inputs,children:[(0,a.jsx)("div",{className:"".concat(d().rows__inputs__titles," ").concat(!A||k?d().no__drag:""),style:{gridTemplateColumns:"repeat(".concat(c,", 1fr)")},children:s.map((e,t)=>(0,a.jsx)("p",{className:d().rows__inputs__title,children:e},t))}),(0,a.jsx)(o.Mp,{sensors:k?[]:G,collisionDetection:o.fp,onDragEnd:e=>{if(k)return;let{active:t,over:r}=e;if(r&&t.id!==r.id){let e=L.indexOf(t.id),a=L.indexOf(r.id);if(-1===e||-1===a)return void console.warn("❌ Не найден индекс для перетаскивания:",{activeId:t.id,overId:r.id,rowIds:L,oldIndex:e,newIndex:a});let n=(0,l.be)(W,e,a);if(!b){let t=(0,l.be)(L,e,a);z(n),O(t)}h&&h(n)}},children:(0,a.jsx)(l.gB,{items:L,strategy:l._G,children:(0,a.jsx)("div",{className:d().rows__inputs__container,children:W.map((e,t)=>{let r=L[t];return r?(0,a.jsx)(g,{inputsTheme:I,extraButtonMinusClass:v,inputType:f,id:r,rowIndex:t,idNames:N,row:e,titles:s,inputsInRowCount:c,extraClass:w[t],isLastRow:t===W.length-1,canRemove:W.length>1,onUpdateValue:K,onRemoveRow:J,hasError:H.includes(t),dropdownOptions:D,canCreateNewOption:E,textAreaProps:S,buttonSizes:B,showDnDButton:A,isOnlyShow:k,onBlur:F,onClick:R,onFocus:M,onKeyUp:q},r):(console.warn("❌ Отсутствует rowId для индекса:",t),null)})})})}),W.length<u&&!k&&(0,a.jsx)("button",{id:"cy-create-card-row-plus-button-".concat((null==N?void 0:N[0])||"default"),className:"".concat(d().rows__inputs__add," ").concat(x),onClick:()=>{if(k||W.length>=u)return;let e=[...W,Array(c).fill("")];if(!b){let t="row-".concat(W.length,"-").concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9));z(e),O([...L,t])}h&&h(e)},type:"button","aria-label":"Добавить строку",children:(0,a.jsx)(i.default,{src:"/create-card/plus-circle.svg",alt:"plus",width:(null==(t=B.plus)?void 0:t.width)||39,height:(null==(r=B.plus)?void 0:r.height)||39})})]}),(C||y>0)&&!k&&(0,a.jsx)("div",{className:d().info__block,children:C&&(0,a.jsx)("p",{className:d().error__message,children:C})})]})}},44481:e=>{e.exports={arrow__none:"CreateCardPriceElements_arrow__none__hC_bQ",create__prices__box:"CreateCardPriceElements_create__prices__box__aA43T",rows__inputs__box__inner:"CreateCardPriceElements_rows__inputs__box__inner__ZSPOC",create__label__title__box:"CreateCardPriceElements_create__label__title__box__sR_8n",create__label__title:"CreateCardPriceElements_create__label__title__6TBGN",rows__inputs__box__inner__description:"CreateCardPriceElements_rows__inputs__box__inner__description__Ryz3D",rows__inputs__box__inner__description__extra:"CreateCardPriceElements_rows__inputs__box__inner__description__extra__JCU3H",right__box:"CreateCardPriceElements_right__box__AU0XT",minus__extra:"CreateCardPriceElements_minus__extra__xmuO2",rows__extra__del:"CreateCardPriceElements_rows__extra__del__iNgrA",seller__date__box__inner:"CreateCardPriceElements_seller__date__box__inner__gsFhz",seller__date__box__inner__date:"CreateCardPriceElements_seller__date__box__inner__date__C2Gl4",seller__title:"CreateCardPriceElements_seller__title__sfWni",seller__date__box:"CreateCardPriceElements_seller__date__box__oCfto",del__box:"CreateCardPriceElements_del__box__aU_nm",package__box:"CreateCardPriceElements_package__box__DlZZi",drop__extra__image__modal__second:"CreateCardPriceElements_drop__extra__image__modal__second__9Dcd6",drop__extra:"CreateCardPriceElements_drop__extra__0_sXI",seller__title__text:"CreateCardPriceElements_seller__title__text__GNWZM"}},70358:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(12115);let n=()=>{let[e,t]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{let e=()=>{t(window.innerWidth)};return t(window.innerWidth),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}},78126:(e,t)=>{"use strict";function r(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},83429:e=>{e.exports={error__message:"RowsInputs_error__message__M0xsG",area__extra__min__height:"RowsInputs_area__extra__min__height__G3rmf",rows__inputs:"RowsInputs_rows__inputs__exzQx",rows__inputs__titles:"RowsInputs_rows__inputs__titles__kc9WL",no__drag:"RowsInputs_no__drag__nKAAP",rows__inputs__title:"RowsInputs_rows__inputs__title__JD4Tp",rows__inputs__container:"RowsInputs_rows__inputs__container__A3wcu",rows__inputs__box:"RowsInputs_rows__inputs__box__QkhKt",rows__inputs__row:"RowsInputs_rows__inputs__row__38eV5",rows__inputs__remove:"RowsInputs_rows__inputs__remove__4aoL4",rows__inputs__add:"RowsInputs_rows__inputs__add___mKW6",gray__bottom__line:"RowsInputs_gray__bottom__line__cNScs",rows__inputs__drag:"RowsInputs_rows__inputs__drag__oInDq",dropdown:"RowsInputs_dropdown__xYdVK",dropdown__trigger:"RowsInputs_dropdown__trigger__RGD4Z",dropdown__value:"RowsInputs_dropdown__value__m4uUe",dropdown__placeholder:"RowsInputs_dropdown__placeholder__tEgFg",dropdown__arrow:"RowsInputs_dropdown__arrow__Shuhs",dropdown__arrow__open:"RowsInputs_dropdown__arrow__open__NRQ6O",dropdown__list:"RowsInputs_dropdown__list___uL1T",dropdown__option:"RowsInputs_dropdown__option__1_uE5",dropdown__option__selected:"RowsInputs_dropdown__option__selected__w7QvE",dropdown__option__create:"RowsInputs_dropdown__option__create__e9oYs",dropdown__separator:"RowsInputs_dropdown__separator__69ljl",dropdown__custom__input__wrapper:"RowsInputs_dropdown__custom__input__wrapper__Gpwky",dropdown__custom__buttons:"RowsInputs_dropdown__custom__buttons__JA8Ml",dropdown__custom__button__confirm:"RowsInputs_dropdown__custom__button__confirm___JIoK",dropdown__custom__button__cancel:"RowsInputs_dropdown__custom__button__cancel__LAta9",error__dropdown:"RowsInputs_error__dropdown__ufgri"}}}]);